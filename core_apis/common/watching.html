<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Watching Resources | Inter-Widget Communication (IWC)</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.5.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    
    
    <link rel="next" href="../../core_apis/data/overview.html" />
    
    
    <link rel="prev" href="../../core_apis/common/listing.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../gitbook/style.css">


        
    <div class="book" data-level="2.1.5" data-basepath="../.." data-revision="1443216548629">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Getting Started</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="getting_started/overview.html">
            
                
                    <a href="../../getting_started/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         Overview
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="getting_started/technologies.html">
            
                
                    <a href="../../getting_started/technologies.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         Technology Stack
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="getting_started/serverComms.html">
            
                
                    <a href="../../getting_started/serverComms.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         Server Communication
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="getting_started/setup.html">
            
                
                    <a href="../../getting_started/setup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         Adding an IWC Client to an Application
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5" data-path="getting_started/connecting.html">
            
                
                    <a href="../../getting_started/connecting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                         Connecting to the Bus
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.6" data-path="quickStart.html">
            
                
                    <a href="../../quickStart.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                         Quick Start
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.7" data-path="getting_started/bus_configuration/overview.html">
            
                
                    <a href="../../getting_started/bus_configuration/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                         Bus Configuration
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.8" data-path="getting_started/api/apis.html">
            
                
                    <a href="../../getting_started/api/apis.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.</b>
                        
                         APIs
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.8.1" data-path="getting_started/api/api_requests.html">
            
                
                    <a href="../../getting_started/api/api_requests.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.1.</b>
                        
                         Sending Requests
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.8.2" data-path="getting_started/api/api_responses.html">
            
                
                    <a href="../../getting_started/api/api_responses.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.2.</b>
                        
                         Receiving Responses
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.8.3" data-path="getting_started/api/api_error.html">
            
                
                    <a href="../../getting_started/api/api_error.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.3.</b>
                        
                         Handling Errors
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.8.4" data-path="getting_started/api/api_example.html">
            
                
                    <a href="../../getting_started/api/api_example.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.4.</b>
                        
                         Example
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="core_apis/overview.html">
            
                
                    <a href="../../core_apis/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Core APIs
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" >
            
            <span><b>2.1.</b> [Common Functionality] (core_apis/common/overview.md)</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1.1" data-path="core_apis/common/storing.html">
            
                
                    <a href="../../core_apis/common/storing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.1.</b>
                        
                         Storing Resources
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.1.2" data-path="core_apis/common/retrieving.html">
            
                
                    <a href="../../core_apis/common/retrieving.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.2.</b>
                        
                         Retrieving Resources
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.1.3" data-path="core_apis/common/removing.html">
            
                
                    <a href="../../core_apis/common/removing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.3.</b>
                        
                         Removing Resources
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.1.4" data-path="core_apis/common/listing.html">
            
                
                    <a href="../../core_apis/common/listing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.4.</b>
                        
                         Listing Resources
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="2.1.5" data-path="core_apis/common/watching.html">
            
                
                    <a href="../../core_apis/common/watching.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.5.</b>
                        
                         Watching Resources
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="core_apis/data/overview.html">
            
                
                    <a href="../../core_apis/data/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Data API
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.2.1" data-path="core_apis/data/children/overview.html">
            
                
                    <a href="../../core_apis/data/children/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                         Children Resources
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.2.1.1" data-path="core_apis/data/children/storing.html">
            
                
                    <a href="../../core_apis/data/children/storing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.1.</b>
                        
                         Storing Children Resources
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.1.2" data-path="core_apis/data/children/storing.html">
            
                
                    <a href="../../core_apis/data/children/storing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.2.</b>
                        
                         Gathering Children Resources
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.1.3" data-path="core_apis/data/children/removing.html">
            
                
                    <a href="../../core_apis/data/children/removing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.3.</b>
                        
                         Removing Children Resources
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="core_apis/intents/overview.html">
            
                
                    <a href="../../core_apis/intents/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         Intents API
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.3.1" data-path="core_apis/intents/registration.html">
            
                
                    <a href="../../core_apis/intents/registration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.1.</b>
                        
                         Intent Registrations
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3.2" data-path="core_apis/intents/invocation.html">
            
                
                    <a href="../../core_apis/intents/invocation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.2.</b>
                        
                         Intent Invocations
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.4" data-path="core_apis/system/overview.html">
            
                
                    <a href="../../core_apis/system/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                         System API
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.4.1" data-path="core_apis/system/launching.html">
            
                
                    <a href="../../core_apis/system/launching.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.1.</b>
                        
                         Launching Applications
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.5" data-path="core_apis/names/overview.html">
            
                
                    <a href="../../core_apis/names/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                         Names API
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="FAQ.html">
            
                
                    <a href="../../FAQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         FAQs
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4" >
            
            <span><b>4.</b> Designing IWC Applications</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> Testing IWC Applications</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Migration from OWF 7</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1" data-path="migration/pubsub_to_setwatch.html">
            
                
                    <a href="../../migration/pubsub_to_setwatch.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         Publish/Subscribe to Set/Watch
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7" >
            
            <span><b>7.</b> Additional Guides</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" data-path="additional_guides/app_integration_guide/README.html">
            
                
                    <a href="../../additional_guides/app_integration_guide/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                         IWC App Integration Guide
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1.1" data-path="additional_guides/app_integration_guide/adding_an_iwc_client_to_an_application.html">
            
                
                    <a href="../../additional_guides/app_integration_guide/adding_an_iwc_client_to_an_application.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.1.</b>
                        
                         Adding an IWC Client to an Application
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.2" data-path="additional_guides/app_integration_guide/connecting_to_the_bus.html">
            
                
                    <a href="../../additional_guides/app_integration_guide/connecting_to_the_bus.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.2.</b>
                        
                         Connecting to the Bus
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.3" data-path="additional_guides/app_integration_guide/making_iwc_api_calls.html">
            
                
                    <a href="../../additional_guides/app_integration_guide/making_iwc_api_calls.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.3.</b>
                        
                         Making IWC API Calls
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.4" data-path="additional_guides/app_integration_guide/iwc_client_files.html">
            
                
                    <a href="../../additional_guides/app_integration_guide/iwc_client_files.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.4.</b>
                        
                         IWC Client Files
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.5" data-path="additional_guides/app_integration_guide/making_iwc_api_calls_asynchronous_responses.html">
            
                
                    <a href="../../additional_guides/app_integration_guide/making_iwc_api_calls_asynchronous_responses.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.5.</b>
                        
                         Making IWC API Calls Recurring Asynchronous Responses
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="IWC Backend Integration Guide/README.html">
            
                
                    <a href="../../IWC Backend Integration Guide/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                         IWC Backend Integration Guide
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.2.1" data-path="IWC Backend Integration Guide/versioning_tool.html">
            
                
                    <a href="../../IWC Backend Integration Guide/versioning_tool.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.1.</b>
                        
                         Versioning Tool
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2.2" data-path="IWC Backend Integration Guide/iwc_components.html">
            
                
                    <a href="../../IWC Backend Integration Guide/iwc_components.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.2.</b>
                        
                         IWC Components
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2.3" data-path="IWC Backend Integration Guide/iframe_peer_html.html">
            
                
                    <a href="../../IWC Backend Integration Guide/iframe_peer_html.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.3.</b>
                        
                         iframe Peer HTML
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2.4" data-path="IWC Backend Integration Guide/gathering_iwc_components_to_host.html">
            
                
                    <a href="../../IWC Backend Integration Guide/gathering_iwc_components_to_host.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.4.</b>
                        
                         Gathering IWC Components to Host
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2.5" data-path="IWC Backend Integration Guide/debugger_html.html">
            
                
                    <a href="../../IWC Backend Integration Guide/debugger_html.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.5.</b>
                        
                         Debugger HTML
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Inter-Widget Communication (IWC)</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_16">
                    
                        <h2 id="watching-a-resource-in-an-api">Watching a resource in an API</h2>
<p>To watch a resource stored in an API for changes, the <strong>watch</strong> action is used.</p>
<p>the promise resolves when a response to the request is handled, <strong>not when a change has occurred</strong>.</p>
<p>The onChange callback is called whenever there is a change in the resource.</p>
<pre><code>var dataApi = client.data();

var onChange = function(reply,done){
    var newVal = reply.entity.newValue;
    var oldVal = reply.entity.oldValue;

    var doneCondition = { &#39;foo&#39;: 1 };

    if(newVal === doneCondition){
        done();
    }

};

dataApi.watch(&#39;/foo&#39;,onChange);
</code></pre><hr>
<p>The value of the onChange callback&#39;s <code>reply</code> argument varies from a normal response (see 
<a href="../../getting_started/api/api_responses.html">Receiving Responses</a>):</p>
<pre><code>{
    &quot;dst&quot;:&quot;20c0f063.b80a890a&quot;,
    &quot;src&quot;:&quot;data.api&quot;,
    &quot;replyTo&quot;:&quot;p:1856&quot;,
    &quot;response&quot;:&quot;changed&quot;,
    &quot;resource&quot;:&quot;/foo&quot;,
    &quot;entity&quot;:{
        &quot;newValue&quot;:{&quot;bar&quot;:&quot;bark&quot;},
        &quot;oldValue&quot;:{&quot;bar&quot;:&quot;buz&quot;},
        &quot;newCollection&quot;:[],
        &quot;oldCollection&quot;:[]
    },
    &quot;ver&quot;:1,
    &quot;msgId&quot;:&quot;i:3761&quot;,
    &quot;time&quot;:1424901227419
}
</code></pre><p><strong>response</strong>: The reply&#39;s response will not be <code>&quot;ok&quot;</code> like a request&#39;s response, rather a <code>&quot;changed&quot;</code> will denote the
value has changed.</p>
<p><strong>entity</strong>: The entity of the reply is not value stored in the resource, rather a report of the change in state of the resource.</p>
<p><strong>entity.newValue</strong>: The new value of the resource.</p>
<p><strong>entity.oldValue</strong>: The old value of the resource.</p>
<p><strong>entity.newCollection</strong>: new collection resources that start with the watched resources pattern. This will be an empty
array if the resource does not have a pattern. (see  <a href="storing.html">Storing Resources</a> for information on
setting the resources pattern).</p>
<p><strong>entity.oldCollection</strong>: old collection resources that start with the watched resources pattern. This will be an empty
array if the resource does not have a pattern.</p>
<h3 id="collection">Collection</h3>
<p>The collection field of a resource defaults to only updating if the following are true:</p>
<ol>
<li>The resource has a <code>pattern</code> property.</li>
<li>The resource is being watched by some connection on the bus.</li>
</ol>
<p>The collection field will continue to update so long as both conditions are true. Some APIs may choose to update 
certain resources based on their own criteria. In these cases, sufficient documentation should be provided to denote 
when and how a resources collection updates.</p>
<h3 id="stoping-a-watch">Stoping a watch</h3>
<p>To stop watching the resource based on its state, calling the <code>done()</code> function passed to the callback will remove
 the watch.</p>
<h3 id="stopping-a-watch-external-to-its-callback">Stopping a watch external to its callback</h3>
<p>In some cases, stopping a watch may be desired outside of the onChange callback. For this reason, there is the <code>unwatch</code>
action. When registering a watch, 2 important properties are returned in the resolution:</p>
<ol>
<li><strong>dst</strong>: the participant that sent the request</li>
<li><strong>replyTo</strong>: the packet that was sent to create the watch</li>
</ol>
<p>With these 2 properties, the watch can be unregistered using <code>unwatch</code> as so:</p>
<pre><code>var watchData = {
    src: null,
    msgId: null
};

dataApi.watch(&#39;/foo&#39;,onChange).then(function(res){
    watchData.src = res.dst;
    watchData.msgId = res.replyTo;

});

// Somewhere else after the watch resolution occurs
dataApi.unwatch(&#39;/foo&#39;,watchData);
</code></pre><h3 id="watching-a-resource-that-does-not-exist">Watching a resource that does not exist</h3>
<p>When registering a watch on a non-existant resource, the promise resolution will return as follows:</p>
<pre><code>{
  &quot;ver&quot;: 1,
  &quot;src&quot;: &quot;data.api&quot;,
  &quot;msgId&quot;: &quot;p:410&quot;,
  &quot;time&quot;: 1435676177310,
  &quot;response&quot;: &quot;ok&quot;,
  &quot;replyTo&quot;: &quot;p:39925&quot;,
  &quot;dst&quot;: &quot;c1f6b99e.21851da2&quot;
}
</code></pre><h3 id="watching-a-resource-that-already-exists">Watching a resource that already exists</h3>
<p>When registering a watch on an existing resource, the promise resolution will be that of a <code>get</code> action:</p>
<pre><code>{
  &quot;ver&quot;: 1,
  &quot;src&quot;: &quot;data.api&quot;,
  &quot;msgId&quot;: &quot;p:41758&quot;,
  &quot;time&quot;: 1435676337690,
  &quot;lifespan&quot;: {
    &quot;type&quot;: &quot;Persistent&quot;
  },
  &quot;permissions&quot;: {},
  &quot;eTag&quot;: 3,
  &quot;resource&quot;: &quot;/balls&quot;,
  &quot;pattern&quot;: &quot;/balls/&quot;,
  &quot;collection&quot;: [
    &quot;/balls/63abb1f0&quot;,
    &quot;/balls/a650bb08&quot;
  ],
  &quot;entity&quot;: {
      &quot;foo&quot;: &quot;bar&quot;
  },
  &quot;response&quot;: &quot;ok&quot;,
  &quot;replyTo&quot;: &quot;p:41340&quot;,
  &quot;dst&quot;: &quot;c1f6b99e.21851da2&quot;
}
</code></pre><h3 id="watching-a-resource-that-gets-deleted">Watching a resource that gets deleted</h3>
<p>When a resource that is being watched gets deleted, the watchers of said resource receive a change notification 
indicating the deletion.</p>
<pre><code>{
    &quot;ver&quot;: 1,
    &quot;src&quot;: &quot;cd78b1cf.21851da2&quot;,
    &quot;msgId&quot;: &quot;p:44993&quot;,
    &quot;time&quot;: 1435676498955,
    &quot;dst&quot;: &quot;c1f6b99e.21851da2&quot;,
    &quot;replyTo&quot;: &quot;p:41340&quot;,
    &quot;response&quot;: &quot;changed&quot;,
    &quot;resource&quot;: &quot;/balls&quot;,
    &quot;permissions&quot;: {},
    &quot;entity&quot;: {
        &quot;newValue&quot;: null,
        &quot;OldValue&quot;:{
            &quot;foo&quot;: &quot;bar&quot;
        },
        &quot;oldCollection&quot;: [
            &quot;/balls/63abb1f0&quot;,
            &quot;/balls/a650bb08&quot;
        ],
        &quot;newCollection&quot;: null,
        &quot;deleted&quot;: true
    }
}
</code></pre><p>The value of <code>entity.deleted</code> will be marked true to indicate the resource has been deleted. The watch will remain active
regardless of deletion and notify if it is recreated. If removing a watch on deletion of a resource is desired, applying
conditional logic for the <code>done()</code> flag based on <code>entity.deleted</code> can produce this functionality.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../core_apis/common/listing.html" class="navigation navigation-prev " aria-label="Previous page: Listing Resources"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../core_apis/data/overview.html" class="navigation navigation-next " aria-label="Next page: Data API"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
