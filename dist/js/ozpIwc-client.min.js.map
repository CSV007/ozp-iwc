{"version":3,"file":"ozpIwc-client.min.js","sources":["ozpIwc-client.js"],"names":["ozpIwc","AsyncAction","this","callbacks","prototype","when","state","callback","self","resolution","apply","value","arguments","resolve","status","Array","slice","call","success","failure","root","factory","define","amd","exports","module","returnExports","doesGetOwnPropertyDescriptorWork","object","sentinel","Object","getOwnPropertyDescriptor","exception","doesDefinePropertyWork","defineProperty","defineGetter","defineSetter","lookupGetter","lookupSetter","Function","prototypeOfObject","owns","bind","hasOwnProperty","supportsAccessors","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupSetter__","getPrototypeOf","proto","__proto__","constructor","getOwnPropertyDescriptorWorksOnObject","getOwnPropertyDescriptorWorksOnDom","document","createElement","getOwnPropertyDescriptorFallback","ERR_NON_OBJECT","property","TypeError","descriptor","enumerable","configurable","notPrototypeOfObject","getter","setter","get","set","writable","getOwnPropertyNames","keys","create","createEmpty","supportsProto","Empty","iframe","parent","body","documentElement","style","display","appendChild","src","empty","contentWindow","removeChild","propertyIsEnumerable","isPrototypeOf","toLocaleString","toString","valueOf","properties","Type","defineProperties","definePropertyWorksOnObject","definePropertyWorksOnDom","definePropertyFallback","definePropertiesFallback","ERR_NON_OBJECT_DESCRIPTOR","ERR_NON_OBJECT_TARGET","ERR_ACCESSORS_NOT_SUPPORTED","seal","freeze","freezeObject","preventExtensions","isSealed","isFrozen","isExtensible","name","returnValue","toInteger","n","Math","floor","abs","isPrimitive","input","type","toPrimitive","val","toStr","isFunction","ArrayPrototype","ObjectPrototype","FunctionPrototype","StringPrototype","String","NumberPrototype","Number","array_slice","array_splice","splice","array_unshift","push","unshift","_toString","isRegex","isArray","obj","isString","isArguments","str","isArgs","length","callee","supportsDescriptors","e","method","forceAssign","map","toObject","o","ToUint32","x","that","target","args","binder","bound","result","concat","boundLength","max","boundArgs","i","join","spliceNoopReturnsEmptyArray","a","spliceWorksWithEmptyObject","start","deleteCount","hasUnshiftReturnValueBug","boxedString","splitString","properlyBoxesContext","properlyBoxesNonStrict","properlyBoxesStrict","_","__","context","forEach","fun","split","thisp","filter","every","some","reduceCoercesToObject","reduce","___","list","reduceRightCoercesToObject","reduceRight","hasFirefox2IndexOfBug","indexOf","sought","hasFirefox2LastIndexOfBug","lastIndexOf","min","hasDontEnumBug","hasProtoEnumBug","dontEnums","dontEnumsLength","isFn","isObject","isStr","theKeys","skipProto","ctor","skipConstructor","j","dontEnum","keysWorksWithArguments","originalKeys","negativeDate","negativeYearString","hasNegativeDateBug","Date","toISOString","year","month","isFinite","RangeError","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","dateToJSONIsSupported","toJSON","NaN","toISO","tv","supportsExtendedYears","parse","acceptsInvalidDates","isNaN","doesNotParseY2KNewYear","NativeDate","Y","M","D","h","m","s","ms","date","dayFromMonth","t","months","toUTC","isoDateExpression","RegExp","key","now","UTC","string","match","exec","day","hour","minute","second","millisecond","isLocalTime","Boolean","signOffset","hourOffset","minuteOffset","getTime","hasToFixedBugs","toFixed","toFixedHelpers","base","size","data","multiply","c","divide","numToString","pow","acc","log","fractionDigits","f","z","k","string_split","compliantExecNpcg","separator","limit","separator2","lastIndex","lastLength","output","flags","ignoreCase","multiline","extended","sticky","lastLastIndex","source","index","replace","test","str_replace","replaceReportsGroupsCorrectly","groups","group","searchValue","replaceValue","hasCapturingGroups","wrappedReplaceValue","originalLastIndex","string_substr","substr","hasNegativeSubstrBug","ws","zeroWidth","wsRegexChars","trimBeginRegexp","trimEndRegexp","hasTrimWhitespaceBug","trim","parseInt","origParseInt","hexRegex","radix","Event","events","on","event","wrapped","ozpIwcDelegateFor","off","trigger","eventName","CancelableEvent","handlers","mixinOnOff","canceled","cancelReason","cancel","reason","window","console","error","util","generateId","random","extend","baseClass","newConstructor","Error","setImmediate","structuredCloneSupport","undefined","cache","onlyStrings","postMessage","blob","Blob","clone","JSON","stringify","arrayContainsAll","haystack","needles","equal","b","needle","hay","objectContainsAll","attribute","parseQueryParams","query","location","search","params","regex","decodeURIComponent","ajax","config","request","XMLHttpRequest","onreadystatechange","readyState","responseText","statusText","open","href","send","setRequestHeader","Client","address","replyCallbacks","peerUrl","peerOrigin","protocol","hostname","port","autoPeer","msgIdSequence","receivedPackets","receivedBytes","sentPackets","sentBytes","startTime","findPeer","postMessageHandler","origin","message","receive","addEventListener","preconnectionQueue","p","fields","promise","packet","replyTo","cancelCallback","preexistingPromise","isConnected","dst","id","ver","msgId","time","peer","disconnect","removeEventListener","createIframePeer","createIframeShim","height","width","setProperty","requestAddress"],"mappings":"AACA,GAAIA,QAAOA,UAOXA,QAAOC,YAAY,WAClBC,KAAKC,cAGNH,OAAOC,YAAYG,UAAUC,KAAK,SAASC,EAAMC,EAASC,GAQzD,MAPGA,GAAKA,GAAQN,KAEbA,KAAKO,aAAeH,EACtBC,EAASG,MAAMF,EAAKN,KAAKS,OAEzBT,KAAKC,UAAUG,GAAO,WAAa,MAAOC,GAASG,MAAMF,EAAKI,YAExDV,MAIRF,OAAOC,YAAYG,UAAUS,QAAQ,SAASC,GAC7C,GAAGZ,KAAKO,WACP,KAAM,gDAEP,IAAIF,GAASL,KAAKC,UAAUW,EAO5B,OANAZ,MAAKO,WAAWK,EAChBZ,KAAKS,MAAMI,MAAMX,UAAUY,MAAMC,KAAKL,UAAU,GAE7CL,GACFA,EAASG,MAAMR,KAAKA,KAAKS,OAEnBT,MAGRF,OAAOC,YAAYG,UAAUc,QAAQ,SAASX,EAASC,GACtD,MAAON,MAAKG,KAAK,UAAUE,EAASC,IAGrCR,OAAOC,YAAYG,UAAUe,QAAQ,SAASZ,EAASC,GACtD,MAAON,MAAKG,KAAK,UAAUE,EAASC,IAepC,SAAUY,EAAMC,GACS,kBAAXC,SAAyBA,OAAOC,IAEvCD,OAAOD,GACmB,gBAAZG,SAIdC,OAAOD,QAAUH,IAGjBD,EAAKM,cAAgBL,KAE3BnB,KAAM,WA4CR,QAASyB,GAAiCC,GACtC,IAEI,MADAA,GAAOC,SAAW,EAIN,IAHLC,OAAOC,yBACNH,EACA,YACNjB,MACJ,MAAOqB,KA8Lb,QAASC,GAAuBL,GAC5B,IAEI,MADAE,QAAOI,eAAeN,EAAQ,eACvB,YAAcA,GACvB,MAAOI,KAnPb,GAKIG,GACAC,EACAC,EACAC,EARArB,EAAOsB,SAASnC,UAAUa,KAC1BuB,EAAoBV,OAAO1B,UAC3BqC,EAAOxB,EAAKyB,KAAKF,EAAkBG,gBAOnCC,EAAoBH,EAAKD,EAAmB,mBA+ChD,IA9CII,IACAT,EAAelB,EAAKyB,KAAKF,EAAkBK,kBAC3CT,EAAenB,EAAKyB,KAAKF,EAAkBM,kBAC3CT,EAAepB,EAAKyB,KAAKF,EAAkBO,kBAC3CT,EAAerB,EAAKyB,KAAKF,EAAkBQ,mBAK1ClB,OAAOmB,iBAQRnB,OAAOmB,eAAiB,SAAwBrB,GAC5C,GAAIsB,GAAQtB,EAAOuB,SACnB,OAAID,IAAmB,OAAVA,EACFA,EACAtB,EAAOwB,YACPxB,EAAOwB,YAAYhD,UAEnBoC,IAsBfV,OAAOI,eAAgB,CACvB,GAAImB,GAAwC1B,MACxC2B,EAAyD,mBAAbC,WAChD5B,EAAiC4B,SAASC,cAAc,OACxD,KAAKF,IAAuCD,EACxC,GAAII,GAAmC3B,OAAOC,yBAItD,IAAKD,OAAOC,0BAA4B0B,EAAkC,CACtE,GAAIC,GAAiB,0DAErB5B,QAAOC,yBAA2B,SAAkCH,EAAQ+B,GACxE,GAAuB,gBAAX/B,IAAyC,kBAAXA,IAAqC,OAAXA,EAChE,KAAM,IAAIgC,WAAUF,EAAiB9B,EAKzC,IAAI6B,EACA,IACI,MAAOA,GAAiCxC,KAAKa,OAAQF,EAAQ+B,GAC/D,MAAO3B,IAMb,GAAKS,EAAKb,EAAQ+B,GAAlB,CAMA,GAAIE,IAAgBC,YAAY,EAAMC,cAAc,EAIpD,IAAInB,EAAmB,CAMnB,GAAIxC,GAAYwB,EAAOuB,UACnBa,EAAuBpC,IAAWY,CAIlCwB,KACApC,EAAOuB,UAAYX,EAGvB,IAAIyB,GAAS5B,EAAaT,EAAQ+B,GAC9BO,EAAS5B,EAAaV,EAAQ+B,EAOlC,IALIK,IAEApC,EAAOuB,UAAY/C,GAGnB6D,GAAUC,EASV,MARID,KACAJ,EAAWM,IAAMF,GAEjBC,IACAL,EAAWO,IAAMF,GAIdL,EAQf,MAFAA,GAAWlD,MAAQiB,EAAO+B,GAC1BE,EAAWQ,UAAW,EACfR,IAcf,GARK/B,OAAOwC,sBACRxC,OAAOwC,oBAAsB,SAA6B1C,GACtD,MAAOE,QAAOyC,KAAK3C,MAMtBE,OAAO0C,OAAQ,CAGhB,GAAIC,GACAC,KAAmBvB,UAAU,eAAiBrB,QAK9C2C,GADAC,GAAqC,mBAAbnB,UACV,WACV,OAASJ,UAAa,OAQZ,WAkBV,QAASwB,MAjBT,GAAIC,GAASrB,SAASC,cAAc,UAChCqB,EAAStB,SAASuB,MAAQvB,SAASwB,eACvCH,GAAOI,MAAMC,QAAU,OACvBJ,EAAOK,YAAYN,GACnBA,EAAOO,IAAM,aACb,IAAIC,GAAQR,EAAOS,cAAcvD,OAAO1B,SAkBxC,OAjBAyE,GAAOS,YAAYV,GACnBA,EAAS,WACFQ,GAAMhC,kBACNgC,GAAMzC,qBACNyC,GAAMG,2BACNH,GAAMI,oBACNJ,GAAMK,qBACNL,GAAMM,eACNN,GAAMO,QACbP,EAAMjC,UAAY,KAGlBwB,EAAMvE,UAAYgF,EAElBX,EAAc,WACV,MAAO,IAAIE,IAER,GAAIA,IAInB7C,OAAO0C,OAAS,SAAgBpE,EAAWwF,GAGvC,QAASC,MADT,GAAIjE,EAGJ,IAAkB,OAAdxB,EACAwB,EAAS6C,QACN,CACH,GAAyB,gBAAdrE,IAA+C,kBAAdA,GAMxC,KAAM,IAAIwD,WAAU,iDAExBiC,GAAKzF,UAAYA,EACjBwB,EAAS,GAAIiE,GAKbjE,EAAOuB,UAAY/C,EAOvB,MAJmB,UAAfwF,GACA9D,OAAOgE,iBAAiBlE,EAAQgE,GAG7BhE,GA2Bf,GAAIE,OAAOI,eAAgB,CACvB,GAAI6D,GAA8B9D,MAC9B+D,EAA+C,mBAAbzC,WAClCtB,EAAuBsB,SAASC,cAAc,OAClD,KAAKuC,IAAgCC,EACjC,GAAIC,GAAyBnE,OAAOI,eAChCgE,EAA2BpE,OAAOgE,iBAI9C,IAAKhE,OAAOI,gBAAkB+D,EAAwB,CAClD,GAAIE,GAA4B,2CAC5BC,EAAwB,+CACxBC,EAA8B,gEAGlCvE,QAAOI,eAAiB,SAAwBN,EAAQ+B,EAAUE,GAC9D,GAAuB,gBAAXjC,IAAyC,kBAAXA,IAAqC,OAAXA,EAChE,KAAM,IAAIgC,WAAUwC,EAAwBxE,EAEhD,IAA2B,gBAAfiC,IAAiD,kBAAfA,IAA6C,OAAfA,EACxE,KAAM,IAAID,WAAUuC,EAA4BtC,EAIpD,IAAIoC,EACA,IACI,MAAOA,GAAuBhF,KAAKa,OAAQF,EAAQ+B,EAAUE,GAC/D,MAAO7B,IAMb,GAAIS,EAAKoB,EAAY,SAgBjB,GAAIjB,IAAsBP,EAAaT,EAAQ+B,IACrBrB,EAAaV,EAAQ+B,IAC/C,CAKI,GAAIvD,GAAYwB,EAAOuB,SACvBvB,GAAOuB,UAAYX,QAGZZ,GAAO+B,GACd/B,EAAO+B,GAAYE,EAAWlD,MAE9BiB,EAAOuB,UAAY/C,MAEnBwB,GAAO+B,GAAYE,EAAWlD,UAE/B,CACH,IAAKiC,EACD,KAAM,IAAIgB,WAAUyC,EAGpB5D,GAAKoB,EAAY,QACjB1B,EAAaP,EAAQ+B,EAAUE,EAAWM,KAE1C1B,EAAKoB,EAAY,QACjBzB,EAAaR,EAAQ+B,EAAUE,EAAWO,KAGlD,MAAOxC,MAMVE,OAAOgE,kBAAoBI,KAC5BpE,OAAOgE,iBAAmB,SAA0BlE,EAAQgE,GAExD,GAAIM,EACA,IACI,MAAOA,GAAyBjF,KAAKa,OAAQF,EAAQgE,GACvD,MAAO5D,IAKb,IAAK,GAAI2B,KAAYiC,GACbnD,EAAKmD,EAAYjC,IAA0B,cAAbA,GAC9B7B,OAAOI,eAAeN,EAAQ+B,EAAUiC,EAAWjC,GAG3D,OAAO/B,KAMVE,OAAOwE,OACRxE,OAAOwE,KAAO,SAAc1E,GAIxB,MAAOA,KAMVE,OAAOyE,SACRzE,OAAOyE,OAAS,SAAgB3E,GAI5B,MAAOA,IAKf,KACIE,OAAOyE,OAAO,cAChB,MAAOvE,GACLF,OAAOyE,OAAS,SAAiBC,GAC7B,MAAO,UAAgB5E,GACnB,MAAsB,kBAAXA,GACAA,EAEA4E,EAAa5E,KAG7BE,OAAOyE,QAKTzE,OAAO2E,oBACR3E,OAAO2E,kBAAoB,SAA2B7E,GAIlD,MAAOA,KAMVE,OAAO4E,WACR5E,OAAO4E,SAAW,WACd,OAAO,IAMV5E,OAAO6E,WACR7E,OAAO6E,SAAW,WACd,OAAO,IAMV7E,OAAO8E,eACR9E,OAAO8E,aAAe,SAAsBhF,GAExC,GAAIE,OAAOF,KAAYA,EACnB,KAAM,IAAIgC,UAId,KADA,GAAIiD,GAAO,GACJpE,EAAKb,EAAQiF,IAChBA,GAAQ,GAEZjF,GAAOiF,IAAQ,CACf,IAAIC,GAAcrE,EAAKb,EAAQiF,EAE/B,cADOjF,GAAOiF,GACPC,MAoBd,SAAU1F,EAAMC,GACS,kBAAXC,SAAyBA,OAAOC,IAEvCD,OAAOD,GACmB,gBAAZG,SAIdC,OAAOD,QAAUH,IAGjBD,EAAKM,cAAgBL,KAE3BnB,KAAM,WAkGR,QAAS6G,GAAUC,GAOf,MANAA,IAAKA,EACDA,IAAMA,EACNA,EAAI,EACS,IAANA,GAAWA,IAAO,EAAI,GAAMA,MAAQ,EAAI,KAC/CA,GAAKA,EAAI,GAAK,IAAMC,KAAKC,MAAMD,KAAKE,IAAIH,KAErCA,EAGX,QAASI,GAAYC,GACjB,GAAIC,SAAcD,EAClB,OACc,QAAVA,GACS,cAATC,GACS,YAATA,GACS,WAATA,GACS,WAATA,EAIR,QAASC,GAAYF,GACjB,GAAIG,GAAK7B,EAAS8B,CAClB,IAAIL,EAAYC,GACZ,MAAOA,EAGX,IADA1B,EAAU0B,EAAM1B,QACZ+B,EAAW/B,KACX6B,EAAM7B,EAAQ1E,KAAKoG,GACfD,EAAYI,IACZ,MAAOA,EAIf,IADAC,EAAQJ,EAAM3B,SACVgC,EAAWD,KACXD,EAAMC,EAAMxG,KAAKoG,GACbD,EAAYI,IACZ,MAAOA,EAGf,MAAM,IAAI5D,WAwBd,QAASe,MArJT,GAmDIzC,GAnDAyF,EAAiB5G,MAAMX,UACvBwH,EAAkB9F,OAAO1B,UACzByH,EAAoBtF,SAASnC,UAC7B0H,EAAkBC,OAAO3H,UACzB4H,EAAkBC,OAAO7H,UACzB8H,EAAcP,EAAe3G,MAC7BmH,EAAeR,EAAeS,OAE9BC,GADaV,EAAeW,KACZX,EAAeY,SAC/BtH,EAAO4G,EAAkB5G,KAGzBuH,EAAYZ,EAAgBlC,SAE5BgC,EAAa,SAAUF,GACvB,MAA8C,sBAAvCI,EAAgBlC,SAASzE,KAAKuG,IAErCiB,EAAU,SAAUjB,GACpB,MAA8C,oBAAvCI,EAAgBlC,SAASzE,KAAKuG,IAErCkB,EAAU,SAAiBC,GAC3B,MAA+B,mBAAxBH,EAAUvH,KAAK0H,IAEtBC,EAAW,SAAkBD,GAC7B,MAA+B,oBAAxBH,EAAUvH,KAAK0H,IAEtBE,EAAc,SAAqBlI,GACnC,GAAImI,GAAMN,EAAUvH,KAAKN,GACrBoI,EAAiB,uBAARD,CASb,OARKC,KACDA,GAAUL,EAAQ/H,IACD,OAAVA,GACiB,gBAAVA,IACiB,gBAAjBA,GAAMqI,QACbrI,EAAMqI,QAAU,GAChBtB,EAAW/G,EAAMsI,SAErBF,GAGPG,EAAsBpH,OAAOI,gBAAmB,WAChD,IAEI,MADAJ,QAAOI,kBAAmB,SACnB,EACT,MAAOiH,GACL,OAAO,KAQXjH,GADAgH,EACiB,SAAUtH,EAAQiF,EAAMuC,EAAQC,IACxCA,GAAgBxC,IAAQjF,IAC7BE,OAAOI,eAAeN,EAAQiF,GAC1B9C,cAAc,EACdD,YAAY,EACZO,UAAU,EACV1D,MAAOyI,KAIE,SAAUxH,EAAQiF,EAAMuC,EAAQC,IACxCA,GAAgBxC,IAAQjF,KAC7BA,EAAOiF,GAAQuC,GAGvB,IAAItD,GAAmB,SAAUlE,EAAQ0H,EAAKD,GAC1C,IAAK,GAAIxC,KAAQyC,GACT1B,EAAgBjF,eAAe1B,KAAKqI,EAAKzC,IAC3C3E,EAAeN,EAAQiF,EAAMyC,EAAIzC,GAAOwC,IA2D9CE,EAAW,SAAUC,GACrB,GAAS,MAALA,EACA,KAAM,IAAI5F,WAAU,iBAAmB4F,EAAI,aAE/C,OAAO1H,QAAO0H,IAGdC,EAAW,SAAkBC,GAC7B,MAAOA,KAAM,EAajB5D,GAAiB+B,GACbnF,KAAM,SAAciH,GAEhB,GAAIC,GAAS1J,IAEb,KAAKwH,EAAWkC,GACZ,KAAM,IAAIhG,WAAU,kDAAoDgG,EAmF5E,KAAK,GA9EDC,GAAO3B,EAAYjH,KAAKL,UAAW,GAUnCkJ,EAAS,WAET,GAAI5J,eAAgB6J,GAAO,CAiBvB,GAAIC,GAASJ,EAAOlJ,MAChBR,KACA2J,EAAKI,OAAO/B,EAAYjH,KAAKL,YAEjC,OAAIkB,QAAOkI,KAAYA,EACZA,EAEJ9J,KAsBP,MAAO0J,GAAOlJ,MACViJ,EACAE,EAAKI,OAAO/B,EAAYjH,KAAKL,cAarCsJ,EAAcjD,KAAKkD,IAAI,EAAGP,EAAOZ,OAASa,EAAKb,QAI/CoB,KACKC,EAAI,EAAOH,EAAJG,EAAiBA,IAC7BD,EAAU9B,KAAK,IAAM+B,EASzB,IAAIN,GAAQxH,SAAS,SAAU,oBAAsB6H,EAAUE,KAAK,KAAO,0CAA0CR,EA8BrH,OA5BIF,GAAOxJ,YACPuE,EAAMvE,UAAYwJ,EAAOxJ,UACzB2J,EAAM3J,UAAY,GAAIuE,GAEtBA,EAAMvE,UAAY,MAwBf2J,IAMf,IAGI5H,GACAC,EACAC,EACAC,EACAM,EAPAH,EAAOxB,EAAKyB,KAAKkF,EAAgBjF,iBAQhCC,EAAoBH,EAAKmF,EAAiB,uBAC3CzF,EAAelB,EAAKyB,KAAKkF,EAAgB/E,kBACzCT,EAAenB,EAAKyB,KAAKkF,EAAgB9E,kBACzCT,EAAepB,EAAKyB,KAAKkF,EAAgB7E,kBACzCT,EAAerB,EAAKyB,KAAKkF,EAAgB5E,kBAU7C,IAAIuH,GAA+B,WAC/B,GAAIC,IAAK,EAAG,GACRR,EAASQ,EAAEpC,QACf,OAAoB,KAAboC,EAAExB,QAAgBN,EAAQsB,IAA6B,IAAlBA,EAAOhB,SAEvDlD,GAAiB6B,GAEbS,OAAQ,WACJ,MAAyB,KAArBxH,UAAUoI,UAGHb,EAAazH,MAAMR,KAAMU,aAGzC2J,EAEH,IAAIE,GAA8B,WAC9B,GAAI9B,KAEJ,OADAhB,GAAeS,OAAOnH,KAAK0H,EAAK,EAAG,EAAG,GAChB,IAAfA,EAAIK,SAEflD,GAAiB6B,GACbS,OAAQ,SAAgBsC,EAAOC,GAC3B,GAAyB,IAArB/J,UAAUoI,OAAgB,QAC9B,IAAIa,GAAOjJ,SAUX,OATAV,MAAK8I,OAAS/B,KAAKkD,IAAIpD,EAAU7G,KAAK8I,QAAS,GAC3CpI,UAAUoI,OAAS,GAA4B,gBAAhB2B,KAC/Bd,EAAO3B,EAAYjH,KAAKL,WACpBiJ,EAAKb,OAAS,EACda,EAAKvB,KAAKpI,KAAK8I,OAAS0B,GAExBb,EAAK,GAAK9C,EAAU4D,IAGrBxC,EAAazH,MAAMR,KAAM2J,MAEpCY,EAOJ,IAAIG,GAA6C,OAAfrC,QAAQ,EAC1CzC,GAAiB6B,GACbY,QAAS,WAEL,MADAF,GAAc3H,MAAMR,KAAMU,WACnBV,KAAK8I,SAEjB4B,GAKH9E,EAAiB/E,OAAS2H,QAASA,GAoBnC,IAAImC,GAAc/I,OAAO,KACrBgJ,EAAiC,MAAnBD,EAAY,MAAgB,IAAKA,IAE/CE,EAAuB,SAAuB3B,GAE9C,GAAI4B,IAAyB,EACzBC,GAAsB,CAW1B,OAVI7B,KACAA,EAAOnI,KAAK,MAAO,SAAUiK,EAAGC,EAAIC,GACT,gBAAZA,KAAwBJ,GAAyB,KAGhE5B,EAAOnI,MAAM,GAAI,WACb,YACAgK,GAAsC,gBAAT/K,OAC9B,QAEEkJ,GAAU4B,GAA0BC,EAGjDnF,GAAiB6B,GACb0D,QAAS,SAAiBC,GACtB,GAAI1J,GAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxD4J,EAAQ5K,UAAU,GAClByJ,EAAI,GACJrB,EAASxI,EAAKwI,SAAW,CAG7B,KAAKtB,EAAW4D,GACZ,KAAM,IAAI1H,UAGd,QAASyG,EAAIrB,GACLqB,IAAK7J,IAIL8K,EAAIrK,KAAKuK,EAAOhL,EAAK6J,GAAIA,EAAGzI,MAIxCmJ,EAAqBpD,EAAe0D,UAKxCvF,EAAiB6B,GACb2B,IAAK,SAAagC,GACd,GAAI1J,GAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxDoH,EAASxI,EAAKwI,SAAW,EACzBgB,EAASjJ,MAAMiI,GACfwC,EAAQ5K,UAAU,EAGtB,KAAK8G,EAAW4D,GACZ,KAAM,IAAI1H,WAAU0H,EAAM,qBAG9B,KAAK,GAAIjB,GAAI,EAAOrB,EAAJqB,EAAYA,IACpBA,IAAK7J,KACLwJ,EAAOK,GAAKiB,EAAIrK,KAAKuK,EAAOhL,EAAK6J,GAAIA,EAAGzI,GAGhD,OAAOoI,MAEXe,EAAqBpD,EAAe2B,MAKxCxD,EAAiB6B,GACb8D,OAAQ,SAAgBH,GACpB,GAII3K,GAJAiB,EAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxDoH,EAASxI,EAAKwI,SAAW,EACzBgB,KAEAwB,EAAQ5K,UAAU,EAGtB,KAAK8G,EAAW4D,GACZ,KAAM,IAAI1H,WAAU0H,EAAM,qBAG9B,KAAK,GAAIjB,GAAI,EAAOrB,EAAJqB,EAAYA,IACpBA,IAAK7J,KACLG,EAAQH,EAAK6J,GACTiB,EAAIrK,KAAKuK,EAAO7K,EAAO0J,EAAGzI,IAC1BoI,EAAO1B,KAAK3H,GAIxB,OAAOqJ,MAEXe,EAAqBpD,EAAe8D,SAKxC3F,EAAiB6B,GACb+D,MAAO,SAAeJ,GAClB,GAAI1J,GAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxDoH,EAASxI,EAAKwI,SAAW,EACzBwC,EAAQ5K,UAAU,EAGtB,KAAK8G,EAAW4D,GACZ,KAAM,IAAI1H,WAAU0H,EAAM,qBAG9B,KAAK,GAAIjB,GAAI,EAAOrB,EAAJqB,EAAYA,IACxB,GAAIA,IAAK7J,KAAS8K,EAAIrK,KAAKuK,EAAOhL,EAAK6J,GAAIA,EAAGzI,GAC1C,OAAO,CAGf,QAAO,KAEXmJ,EAAqBpD,EAAe+D,QAKxC5F,EAAiB6B,GACbgE,KAAM,SAAcL,GAChB,GAAI1J,GAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxDoH,EAASxI,EAAKwI,SAAW,EACzBwC,EAAQ5K,UAAU,EAGtB,KAAK8G,EAAW4D,GACZ,KAAM,IAAI1H,WAAU0H,EAAM,qBAG9B,KAAK,GAAIjB,GAAI,EAAOrB,EAAJqB,EAAYA,IACxB,GAAIA,IAAK7J,IAAQ8K,EAAIrK,KAAKuK,EAAOhL,EAAK6J,GAAIA,EAAGzI,GACzC,OAAO,CAGf,QAAO,KAEXmJ,EAAqBpD,EAAegE,MAKxC,IAAIC,IAAwB,CACxBjE,GAAekE,SACfD,EAAmH,gBAApFjE,GAAekE,OAAO5K,KAAK,MAAO,SAAUiK,EAAGC,EAAIW,EAAKC,GAAQ,MAAOA,MAE1GjG,EAAiB6B,GACbkE,OAAQ,SAAgBP,GACpB,GAAI1J,GAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxDoH,EAASxI,EAAKwI,SAAW,CAG7B,KAAKtB,EAAW4D,GACZ,KAAM,IAAI1H,WAAU0H,EAAM,qBAI9B,KAAKtC,GAA+B,IAArBpI,UAAUoI,OACrB,KAAM,IAAIpF,WAAU,8CAGxB,IACIoG,GADAK,EAAI,CAER,IAAIzJ,UAAUoI,QAAU,EACpBgB,EAASpJ,UAAU,OAEnB,QAAG,CACC,GAAIyJ,IAAK7J,GAAM,CACXwJ,EAASxJ,EAAK6J,IACd,OAIJ,KAAMA,GAAKrB,EACP,KAAM,IAAIpF,WAAU,+CAKhC,KAAWoF,EAAJqB,EAAYA,IACXA,IAAK7J,KACLwJ,EAASsB,EAAIrK,KAAK,OAAQ+I,EAAQxJ,EAAK6J,GAAIA,EAAGzI,GAItD,OAAOoI,MAEX4B,EAKJ,IAAII,IAA6B,CAC7BrE,GAAesE,cACfD,EAA6H,gBAAzFrE,GAAesE,YAAYhL,KAAK,MAAO,SAAUiK,EAAGC,EAAIW,EAAKC,GAAQ,MAAOA,MAEpHjG,EAAiB6B,GACbsE,YAAa,SAAqBX,GAC9B,GAAI1J,GAAS2H,EAASrJ,MAClBM,EAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAM3J,EACxDoH,EAASxI,EAAKwI,SAAW,CAG7B,KAAKtB,EAAW4D,GACZ,KAAM,IAAI1H,WAAU0H,EAAM,qBAI9B,KAAKtC,GAA+B,IAArBpI,UAAUoI,OACrB,KAAM,IAAIpF,WAAU,mDAGxB,IAAIoG,GAAQK,EAAIrB,EAAS,CACzB,IAAIpI,UAAUoI,QAAU,EACpBgB,EAASpJ,UAAU,OAEnB,QAAG,CACC,GAAIyJ,IAAK7J,GAAM,CACXwJ,EAASxJ,EAAK6J,IACd,OAIJ,KAAMA,EAAI,EACN,KAAM,IAAIzG,WAAU,oDAKhC,GAAQ,EAAJyG,EACA,MAAOL,EAGX,GACQK,KAAK7J,KACLwJ,EAASsB,EAAIrK,KAAK,OAAQ+I,EAAQxJ,EAAK6J,GAAIA,EAAGzI,UAE7CyI,IAET,OAAOL,MAEXgC,EAKJ,IAAIE,GAAwBnL,MAAMX,UAAU+L,SAAoC,MAAxB,EAAG,GAAGA,QAAQ,EAAG,EACzErG,GAAiB6B,GACbwE,QAAS,SAAiBC,GACtB,GAAI5L,GAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAMhC,EAASrJ,MACjE8I,EAASxI,EAAKwI,SAAW,CAE7B,KAAKA,EACD,MAAO,EAGX,IAAIqB,GAAI,CAOR,KANIzJ,UAAUoI,OAAS,IACnBqB,EAAItD,EAAUnG,UAAU,KAI5ByJ,EAAIA,GAAK,EAAIA,EAAIpD,KAAKkD,IAAI,EAAGnB,EAASqB,GAC3BrB,EAAJqB,EAAYA,IACf,GAAIA,IAAK7J,IAAQA,EAAK6J,KAAO+B,EACzB,MAAO/B,EAGf,OAAO,KAEZ6B,EAKH,IAAIG,GAA4BtL,MAAMX,UAAUkM,aAA6C,MAA7B,EAAG,GAAGA,YAAY,EAAG,GACrFxG,GAAiB6B,GACb2E,YAAa,SAAqBF,GAC9B,GAAI5L,GAAOsK,GAAelC,EAAS1I,MAAQA,KAAKqL,MAAM,IAAMhC,EAASrJ,MACjE8I,EAASxI,EAAKwI,SAAW,CAE7B,KAAKA,EACD,MAAO,EAEX,IAAIqB,GAAIrB,EAAS,CAMjB,KALIpI,UAAUoI,OAAS,IACnBqB,EAAIpD,KAAKsF,IAAIlC,EAAGtD,EAAUnG,UAAU,MAGxCyJ,EAAIA,GAAK,EAAIA,EAAIrB,EAAS/B,KAAKE,IAAIkD,GAC5BA,GAAK,EAAGA,IACX,GAAIA,IAAK7J,IAAQ4L,IAAW5L,EAAK6J,GAC7B,MAAOA,EAGf,OAAO,KAEZgC,EAWH,IAAIG,KAAoB9G,SAAY,MAAOH,qBAAqB,YAC5DkH,EAAkB,aAAiBlH,qBAAqB,aACxDmH,GACI,WACA,iBACA,UACA,iBACA,gBACA,uBACA,eAEJC,EAAkBD,EAAU1D,MAEhClD,GAAiBhE,QACbyC,KAAM,SAAc3C,GAChB,GAAIgL,GAAOlF,EAAW9F,GAClBmH,EAASF,EAAYjH,GACrBiL,EAAsB,OAAXjL,GAAqC,gBAAXA,GACrCkL,EAAQD,GAAYjE,EAAShH,EAEjC,KAAKiL,IAAaD,IAAS7D,EACvB,KAAM,IAAInF,WAAU,qCAGxB,IAAImJ,MACAC,EAAYP,GAAmBG,CACnC,IAAIE,GAAS/D,EACT,IAAK,GAAIsB,GAAI,EAAGA,EAAIzI,EAAOoH,SAAUqB,EACjC0C,EAAQzE,KAAKP,OAAOsC,QAGxB,KAAK,GAAIxD,KAAQjF,GACPoL,GAAsB,cAATnG,IAAyBpE,EAAKb,EAAQiF,IACrDkG,EAAQzE,KAAKP,OAAOlB,GAKhC,IAAI2F,EAGA,IAAK,GAFDS,GAAOrL,EAAOwB,YACd8J,EAAkBD,GAAQA,EAAK7M,YAAcwB,EACxCuL,EAAI,EAAOR,EAAJQ,EAAqBA,IAAK,CACtC,GAAIC,GAAWV,EAAUS,EACnBD,IAAgC,gBAAbE,IAA+B3K,EAAKb,EAAQwL,IACjEL,EAAQzE,KAAK8E,GAIzB,MAAOL,KAIf,IAAIM,GAAyBvL,OAAOyC,MAAS,WAEzC,MAAyC,KAAlCzC,OAAOyC,KAAK3D,WAAWoI,QAChC,EAAG,GACDsE,EAAexL,OAAOyC,IAC1BuB,GAAiBhE,QACbyC,KAAM,SAAc3C,GAChB,MACW0L,GADPzE,EAAYjH,GACQ+F,EAAe3G,MAAMC,KAAKW,GAE1BA,MAG5ByL,EAcJ,IAAIE,GAAe,aACfC,EAAqB,UACrBC,EAAqBC,KAAKtN,UAAUuN,aAAoF,KAArE,GAAID,MAAKH,GAAcI,cAAcxB,QAAQqB,EAEpG1H,GAAiB4H,KAAKtN,WAClBuN,YAAa,WACT,GAAI3D,GAAQhB,EAAQrI,EAAOiN,EAAMC,CACjC,KAAKC,SAAS5N,MACV,KAAM,IAAI6N,YAAW,yDAkBzB,KAfAH,EAAO1N,KAAK8N,iBAEZH,EAAQ3N,KAAK+N,cAEbL,GAAQ3G,KAAKC,MAAM2G,EAAQ,IAC3BA,GAASA,EAAQ,GAAK,IAAM,GAG5B7D,GAAU6D,EAAQ,EAAG3N,KAAKgO,aAAchO,KAAKiO,cAAejO,KAAKkO,gBAAiBlO,KAAKmO,iBACvFT,GACY,EAAPA,EAAW,IAAOA,EAAO,KAAO,IAAM,KACtC,QAAU3G,KAAKE,IAAIyG,IAAO5M,MAAW4M,GAAL,GAAqB,MAARA,EAAe,GAAK,IAGtE5E,EAASgB,EAAOhB,OACTA,KACHrI,EAAQqJ,EAAOhB,GAGH,GAARrI,IACAqJ,EAAOhB,GAAU,IAAMrI,EAI/B,OACIiN,GAAO,IAAM5D,EAAOhJ,MAAM,EAAG,GAAGsJ,KAAK,KACrC,IAAMN,EAAOhJ,MAAM,GAAGsJ,KAAK,KAAO,KACjC,MAAQpK,KAAKoO,sBAAsBtN,MAAM,IAAM,MAGzDyM,EAOH,IAAIc,IAAwB,CAC5B,KACIA,EACIb,KAAKtN,UAAUoO,QACY,OAA3B,GAAId,MAAKe,KAAKD,UACkD,KAAhE,GAAId,MAAKH,GAAciB,SAASrC,QAAQqB,IACxCE,KAAKtN,UAAUoO,OAAOvN,MAClB0M,YAAa,WACT,OAAO,KAIrB,MAAOxE,IAEJoF,IACDb,KAAKtN,UAAUoO,OAAS,WAOpB,GAEIE,GAFAlF,EAAI1H,OAAO5B,MACXyO,EAAKpH,EAAYiC,EAGrB,IAAkB,gBAAPmF,KAAoBb,SAASa,GACpC,MAAO,KAMX,IAFAD,EAAQlF,EAAEmE,YAEW,kBAAVe,GACP,KAAM,IAAI9K,WAAU,uCAIxB,OAAO8K,GAAMzN,KAAKuI,IAiB1B,IAAIoF,GAAsE,OAA9ClB,KAAKmB,MAAM,+BACnCC,GAAuBC,MAAMrB,KAAKmB,MAAM,+BAAiCE,MAAMrB,KAAKmB,MAAM,6BAC1FG,EAAyBD,MAAMrB,KAAKmB,MAAM,+BACzCnB,KAAKmB,OAASG,GAA0BF,IAAwBF,KAGjElB,KAAO,SAAWuB,GAGd,QAASvB,GAAKwB,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,GAC5B,GAAIxG,GAASpI,UAAUoI,MACvB,IAAI9I,eAAgB+O,GAAY,CAC5B,GAAIQ,GAAkB,IAAXzG,GAAgBjB,OAAOmH,KAAOA,EAErC,GAAID,GAAWvB,EAAKmB,MAAMK,IAG1BlG,GAAU,EAAI,GAAIiG,GAAWC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,GAC/CxG,GAAU,EAAI,GAAIiG,GAAWC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,GAC5CvG,GAAU,EAAI,GAAIiG,GAAWC,EAAGC,EAAGC,EAAGC,EAAGC,GACzCtG,GAAU,EAAI,GAAIiG,GAAWC,EAAGC,EAAGC,EAAGC,GACtCrG,GAAU,EAAI,GAAIiG,GAAWC,EAAGC,EAAGC,GACnCpG,GAAU,EAAI,GAAIiG,GAAWC,EAAGC,GAChCnG,GAAU,EAAI,GAAIiG,GAAWC,GACf,GAAID,EAGtB,OADAQ,GAAKrM,YAAcsK,EACZ+B,EAEX,MAAOR,GAAWvO,MAAMR,KAAMU,WA8BlC,QAAS8O,GAAa9B,EAAMC,GACxB,GAAI8B,GAAI9B,EAAQ,EAAI,EAAI,CACxB,OACI+B,GAAO/B,GACP5G,KAAKC,OAAO0G,EAAO,KAAO+B,GAAK,GAC/B1I,KAAKC,OAAO0G,EAAO,KAAO+B,GAAK,KAC/B1I,KAAKC,OAAO0G,EAAO,KAAO+B,GAAK,KAC/B,KAAO/B,EAAO,MAItB,QAASiC,GAAMF,GACX,MAAO1H,QAAO,GAAIgH,GAAW,KAAM,EAAG,EAAG,EAAG,EAAG,EAAGU,IAtCtD,GAAIG,GAAoB,GAAIC,QAAO,2IAsB/BH,GACA,EAAG,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAmB3D,KAAK,GAAII,KAAOf,GACZvB,EAAKsC,GAAOf,EAAWe,EAkE3B,OA9DAtC,GAAKuC,IAAMhB,EAAWgB,IACtBvC,EAAKwC,IAAMjB,EAAWiB,IACtBxC,EAAKtN,UAAY6O,EAAW7O,UAC5BsN,EAAKtN,UAAUgD,YAAcsK,EAG7BA,EAAKmB,MAAQ,SAAesB,GACxB,GAAIC,GAAQN,EAAkBO,KAAKF,EACnC,IAAIC,EAAO,CAIP,GAcIpG,GAdA4D,EAAO3F,OAAOmI,EAAM,IACpBvC,EAAQ5F,OAAOmI,EAAM,IAAM,GAAK,EAChCE,EAAMrI,OAAOmI,EAAM,IAAM,GAAK,EAC9BG,EAAOtI,OAAOmI,EAAM,IAAM,GAC1BI,EAASvI,OAAOmI,EAAM,IAAM,GAC5BK,EAASxI,OAAOmI,EAAM,IAAM,GAC5BM,EAAczJ,KAAKC,MAA8B,IAAxBe,OAAOmI,EAAM,IAAM,IAI5CO,EAAcC,QAAQR,EAAM,KAAOA,EAAM,IACzCS,EAA0B,MAAbT,EAAM,GAAa,EAAI,GACpCU,EAAa7I,OAAOmI,EAAM,KAAO,GACjCW,EAAe9I,OAAOmI,EAAM,KAAO,EAEvC,QAEQI,EAAS,GAAKC,EAAS,GAAKC,EAAc,EAC1C,GAAK,IAFTH,GAIS,GAATC,GAAwB,GAATC,GAA6B,IAAdC,GAC9B7C,EAAQ,IAAc,GAARA,GAA2B,GAAbiD,GACb,GAAfC,GACAT,EAAM,IACNA,EACIZ,EAAa9B,EAAMC,EAAQ,GAC3B6B,EAAa9B,EAAMC,KAGvB7D,EAII,IAHoC,IAAnC0F,EAAa9B,EAAMC,GAASyC,GAC7BC,EACAO,EAAaD,GAEjB7G,EAGI,KAFgD,IAA/CA,EAASwG,EAASO,EAAeF,GAClCJ,GACOC,EACPC,IACA3G,EAAS6F,EAAM7F,IAEHA,GAAZ,SAAgC,QAAVA,GACfA,EAGRyE,IAEX,MAAOQ,GAAWJ,MAAMnO,MAAMR,KAAMU,YAGjC8M,GACRA,OAKFA,KAAKuC,MACNvC,KAAKuC,IAAM,WACP,OAAO,GAAIvC,OAAOsD,WAY1B,IAAIC,IAAiBjJ,EAAgBkJ,UACV,UAAzB,KAAUA,QAAQ,IACM,MAArB,GAAMA,QAAQ,IACS,SAAvB,MAAQA,QAAQ,IACqB,wBAArC,kBAAsBA,QAAQ,IAG/BC,IACFC,KAAM,IACNC,KAAM,EACNC,MAAO,EAAG,EAAG,EAAG,EAAG,EAAG,GACtBC,SAAU,SAAkBvK,EAAGwK,GAE3B,IADA,GAAInH,GAAI,KACCA,EAAI8G,GAAeE,MACxBG,GAAKxK,EAAImK,GAAeG,KAAKjH,GAC7B8G,GAAeG,KAAKjH,GAAKmH,EAAIL,GAAeC,KAC5CI,EAAIvK,KAAKC,MAAMsK,EAAIL,GAAeC,OAG1CK,OAAQ,SAAgBzK,GAEpB,IADA,GAAIqD,GAAI8G,GAAeE,KAAMG,EAAI,IACxBnH,GAAK,GACVmH,GAAKL,GAAeG,KAAKjH,GACzB8G,GAAeG,KAAKjH,GAAKpD,KAAKC,MAAMsK,EAAIxK,GACxCwK,EAAKA,EAAIxK,EAAKmK,GAAeC,MAGrCM,YAAa,WAGT,IAFA,GAAIrH,GAAI8G,GAAeE,KACnB9B,EAAI,KACClF,GAAK,GACV,GAAU,KAANkF,GAAkB,IAANlF,GAAsC,IAA3B8G,GAAeG,KAAKjH,GAAU,CACrD,GAAIsF,GAAI5H,OAAOoJ,GAAeG,KAAKjH,GACzB,MAANkF,EACAA,EAAII,EAEJJ,GAAK,UAAUvO,MAAM,EAAG,EAAI2O,EAAE3G,QAAU2G,EAIpD,MAAOJ,IAEXoC,IAAK,QAASA,IAAIjI,EAAG1C,EAAG4K,GACpB,MAAc,KAAN5K,EAAU4K,EAAO5K,EAAI,IAAM,EAAI2K,GAAIjI,EAAG1C,EAAI,EAAG4K,EAAMlI,GAAKiI,GAAIjI,EAAIA,EAAG1C,EAAI,EAAG4K,IAEtFC,IAAK,SAAanI,GAEd,IADA,GAAI1C,GAAI,EACD0C,GAAK,MACR1C,GAAK,GACL0C,GAAK,IAET,MAAOA,GAAK,GACR1C,GAAK,EACL0C,GAAK,CAET,OAAO1C,IAIblB,GAAiBkC,GACbkJ,QAAS,SAAiBY,GACtB,GAAIC,GAAGrI,EAAG6F,EAAGD,EAAGnG,EAAG6I,EAAG7E,EAAG8E,CAMzB,IAHAF,EAAI9J,OAAO6J,GACXC,EAAIA,IAAMA,EAAI,EAAI9K,KAAKC,MAAM6K,GAErB,EAAJA,GAASA,EAAI,GACb,KAAM,IAAIhE,YAAW,wDAMzB,IAHArE,EAAIzB,OAAO/H,MAGPwJ,IAAMA,EACN,MAAO,KAIX,IAAS,OAALA,GAAcA,GAAK,KACnB,MAAO3B,QAAO2B,EAYlB,IATA6F,EAAI,GAEI,EAAJ7F,IACA6F,EAAI,IACJ7F,GAAKA,GAGT4F,EAAI,IAEA5F,EAAI,MAUJ,GAPAP,EAAIgI,GAAeU,IAAInI,EAAIyH,GAAeQ,IAAI,EAAG,GAAI,IAAM,GAC3DK,EAAS,EAAJ7I,EAAQO,EAAIyH,GAAeQ,IAAI,GAAIxI,EAAG,GAAKO,EAAIyH,GAAeQ,IAAI,EAAGxI,EAAG,GAC7E6I,GAAK,iBACL7I,EAAI,GAAKA,EAILA,EAAI,EAAG,CAIP,IAHAgI,GAAeI,SAAS,EAAGS,GAC3B7E,EAAI4E,EAEG5E,GAAK,GACRgE,GAAeI,SAAS,IAAK,GAC7BpE,GAAK,CAMT,KAHAgE,GAAeI,SAASJ,GAAeQ,IAAI,GAAIxE,EAAG,GAAI,GACtDA,EAAIhE,EAAI,EAEDgE,GAAK,IACRgE,GAAeM,OAAO,GAAK,IAC3BtE,GAAK,EAGTgE,IAAeM,OAAO,GAAKtE,GAC3BgE,GAAeI,SAAS,EAAG,GAC3BJ,GAAeM,OAAO,GACtBnC,EAAI6B,GAAeO,kBAEnBP,IAAeI,SAAS,EAAGS,GAC3Bb,GAAeI,SAAS,IAAOpI,EAAI,GACnCmG,EAAI6B,GAAeO,cAAgB,yBAAyB1Q,MAAM,EAAG,EAAI+Q,EAgBjF,OAZIA,GAAI,GACJE,EAAI3C,EAAEtG,OAGFsG,EADKyC,GAALE,EACI1C,EAAI,wBAAwBvO,MAAM,EAAG+Q,EAAIE,EAAI,GAAK3C,EAElDC,EAAID,EAAEtO,MAAM,EAAGiR,EAAIF,GAAK,IAAMzC,EAAEtO,MAAMiR,EAAIF,IAGlDzC,EAAIC,EAAID,EAGLA,IAEZ2B,GAuBH,IAAIiB,IAAepK,EAAgByD,KAEE,KAAjC,KAAKA,MAAM,WAAWvC,QACW,IAAjC,IAAIuC,MAAM,YAAYvC,QACO,MAA7B,QAAQuC,MAAM,QAAQ,IACc,IAApC,OAAOA,MAAM,OAAQ,IAAIvC,QACzB,GAAGuC,MAAM,MAAMvC,QACf,IAAIuC,MAAM,QAAQvC,OAAS,GAE1B,WACG,GAAImJ,GAA2C,SAAvB,OAAO9B,KAAK,IAAI,EAExCvI,GAAgByD,MAAQ,SAAU6G,EAAWC,GACzC,GAAIlC,GAASjQ,IACb,IAAkB,SAAdkS,GAAkC,IAAVC,EACxB,QAIJ,IAAkC,oBAA9B7J,EAAUvH,KAAKmR,GACf,MAAOF,IAAajR,KAAKf,KAAMkS,EAAWC,EAG9C,IAOIC,GAAYlC,EAAOmC,EAAWC,EAP9BC,KACAC,GAASN,EAAUO,WAAa,IAAM,KAC7BP,EAAUQ,UAAa,IAAM,KAC7BR,EAAUS,SAAa,IAAM,KAC7BT,EAAUU,OAAa,IAAM,IACtCC,EAAgB,CAmBpB,KAhBAX,EAAY,GAAIrC,QAAOqC,EAAUY,OAAQN,EAAQ,KACjDvC,GAAU,GACLgC,IAEDG,EAAa,GAAIvC,QAAO,IAAMqC,EAAUY,OAAS,WAAYN,IASjEL,EAAkB,SAAVA,EACJ,KAAO,EACP5I,EAAS4I,IACNjC,EAAQgC,EAAU/B,KAAKF,MAE1BoC,EAAYnC,EAAM6C,MAAQ7C,EAAM,GAAGpH,SAC/BuJ,EAAYQ,IACZN,EAAOnK,KAAK6H,EAAOnP,MAAM+R,EAAe3C,EAAM6C,SAGzCd,GAAqB/B,EAAMpH,OAAS,GACrCoH,EAAM,GAAG8C,QAAQZ,EAAY,WACzB,IAAK,GAAIjI,GAAI,EAAGA,EAAIzJ,UAAUoI,OAAS,EAAGqB,IACjB,SAAjBzJ,UAAUyJ,KACV+F,EAAM/F,GAAK,UAKvB+F,EAAMpH,OAAS,GAAKoH,EAAM6C,MAAQ9C,EAAOnH,QACzCrB,EAAeW,KAAK5H,MAAM+R,EAAQrC,EAAMpP,MAAM,IAElDwR,EAAapC,EAAM,GAAGpH,OACtB+J,EAAgBR,EACZE,EAAOzJ,QAAUqJ,MAIrBD,EAAUG,YAAcnC,EAAM6C,OAC9Bb,EAAUG,WAUlB,OAPIQ,KAAkB5C,EAAOnH,QACrBwJ,IAAeJ,EAAUe,KAAK,MAC9BV,EAAOnK,KAAK,IAGhBmK,EAAOnK,KAAK6H,EAAOnP,MAAM+R,IAEtBN,EAAOzJ,OAASqJ,EAAQI,EAAOzR,MAAM,EAAGqR,GAASI,MAUzD,IAAIlH,MAAM,OAAQ,GAAGvC,SAC5BlB,EAAgByD,MAAQ,SAAe6G,EAAWC,GAC9C,MAAkB,UAAdD,GAAkC,IAAVC,KACrBH,GAAajR,KAAKf,KAAMkS,EAAWC,IAIlD,IAAIe,IAActL,EAAgBoL,QAC9BG,GAAiC,WACjC,GAAIC,KAIJ,OAHA,IAAIJ,QAAQ,SAAU,SAAU9C,EAAOmD,GACnCD,EAAOhL,KAAKiL,KAES,IAAlBD,EAAOtK,QAAqC,mBAAdsK,GAAO,KAG3CD,MACDvL,EAAgBoL,QAAU,SAAiBM,EAAaC,GACpD,GAAI7G,GAAOlF,EAAW+L,GAClBC,EAAqBjL,EAAQ+K,IAAgB,SAAWL,KAAKK,EAAYR,OAC7E,IAAKpG,GAAS8G,EAEP,CACH,GAAIC,GAAsB,SAAUvD,GAChC,GAAIpH,GAASpI,UAAUoI,OACnB4K,EAAoBJ,EAAYjB,SACpCiB,GAAYjB,UAAY,CACxB,IAAI1I,GAAO2J,EAAYnD,KAAKD,EAG5B,OAFAoD,GAAYjB,UAAYqB,EACxB/J,EAAKvB,KAAK1H,UAAUoI,EAAS,GAAIpI,UAAUoI,EAAS,IAC7CyK,EAAa/S,MAAMR,KAAM2J,GAEpC,OAAOuJ,IAAYnS,KAAKf,KAAMsT,EAAaG,GAX3C,MAAOP,IAAYnS,KAAKf,KAAMsT,EAAaC,IAqBvD,IAAII,IAAgB/L,EAAgBgM,OAChCC,GAAuB,GAAGD,QAA8B,MAApB,KAAKA,OAAO,GACpDhO,GAAiBgC,GACbgM,OAAQ,SAAgBpJ,EAAO1B,GAC3B,MAAO6K,IAAc5S,KACjBf,KACQ,EAARwK,IAAcA,EAAQxK,KAAK8I,OAAS0B,GAAS,EAAI,EAAaA,EAC9D1B,KAGT+K,GAIH,IAAIC,IAAK,0CAGLC,GAAY,IACZC,GAAe,IAAMF,GAAK,IAC1BG,GAAkB,GAAIpE,QAAO,IAAMmE,GAAeA,GAAe,KACjEE,GAAgB,GAAIrE,QAAOmE,GAAeA,GAAe,MACzDG,GAAuBvM,EAAgBwM,OAASN,GAAGM,SAAWL,GAAUK,OAC5ExO,GAAiBgC,GAGbwM,KAAM,WACF,GAAa,SAATpU,MAA4B,OAATA,KACnB,KAAM,IAAI0D,WAAU,iBAAmB1D,KAAO,aAElD,OAAO6H,QAAO7H,MAAMgT,QAAQiB,GAAiB,IAAIjB,QAAQkB,GAAe,MAE7EC,KAGyB,IAAxBE,SAASP,GAAK,OAAyC,KAA1BO,SAASP,GAAK,WAC3CO,SAAY,SAAUC,GAClB,GAAIC,GAAW,QACf,OAAO,UAAqB3L,EAAK4L,GAK7B,MAJA5L,GAAMf,OAAOe,GAAKwL,OACbrM,OAAOyM,KACRA,EAAQD,EAAStB,KAAKrK,GAAO,GAAK,IAE/B0L,EAAa1L,EAAK4L,KAE/BH,YAMN,IAAIvU,QAAOA,UAKXA,QAAO2U,MAAM,WACZzU,KAAK0U,WAUN5U,OAAO2U,MAAMvU,UAAUyU,GAAG,SAASC,EAAMvU,EAASC,GACjD,GAAIuU,GAAQxU,CASZ,OARGC,KACFuU,EAAQ,WACPxU,EAASG,MAAMF,EAAKI,YAErBmU,EAAQC,kBAAkBzU,GAE3BL,KAAK0U,OAAOE,GAAO5U,KAAK0U,OAAOE,OAC/B5U,KAAK0U,OAAOE,GAAOxM,KAAKyM,GACjBA,GAQR/U,OAAO2U,MAAMvU,UAAU6U,IAAI,SAASH,EAAMvU,GACzCL,KAAK0U,OAAOE,IAAQ5U,KAAK0U,OAAOE,QAAYrJ,OAAQ,SAAS4D,GAC5D,MAAOA,KAAI9O,GAAY8O,EAAE2F,oBAAsBzU,KAUjDP,OAAO2U,MAAMvU,UAAU8U,QAAQ,SAASC,EAAUL,GACjDA,EAAQA,GAAS,GAAI9U,QAAOoV,eAC5B,IAAIC,GAASnV,KAAK0U,OAAOO,MAKzB,OAHAE,GAAShK,QAAQ,SAASgE,GACzBA,EAAEyF,KAEIA,GAQR9U,OAAO2U,MAAMvU,UAAUkV,WAAW,SAAS1L,GAC1C,GAAIpJ,GAAKN,IACT0J,GAAOiL,GAAG,WAAa,MAAOrU,GAAKqU,GAAGnU,MAAMF,EAAKI,YACjDgJ,EAAOqL,IAAI,WAAa,MAAOzU,GAAKyU,IAAIvU,MAAMF,EAAKI,aAUpDZ,OAAOoV,gBAAgB,SAAS9D,GAC/BA,EAAOA,KACP,KAAI,GAAIW,KAAKX,GACZpR,KAAK+R,GAAGX,EAAKW,EAEd/R,MAAKqV,UAAS,EACdrV,KAAKsV,aAAa,MAQnBxV,OAAOoV,gBAAgBhV,UAAUqV,OAAO,SAASC,GAIhD,MAHAA,GAAQA,GAAU,UAClBxV,KAAKqV,UAAS,EACdrV,KAAKsV,aAAaE,EACXxV,KAIR,IAAIF,QAAOA,UAOXA,QAAO6R,IAAI7R,OAAO6R,MACjBA,IAAK,WACD8D,OAAOC,SAAwC,kBAAtBD,QAAOC,QAAW,KAC7CD,OAAOC,QAAQ/D,IAAInR,MAAMiV,OAAOC,QAAQhV,YAG1CiV,MAAO,WACHF,OAAOC,SAA0C,kBAAxBD,QAAOC,QAAa,OAC/CD,OAAOC,QAAQC,MAAMnV,MAAMiV,OAAOC,QAAQhV,YAM7C,IAAIZ,QAAOA,UAGXA,QAAO8V,KAAK9V,OAAO8V,SAMnB9V,OAAO8V,KAAKC,WAAW,WACnB,MAAO9O,MAAKC,MAAsB,WAAhBD,KAAK+O,UAAuBtQ,SAAS,KAQ3D1F,OAAO8V,KAAK7F,IAAI,WACZ,OAAO,GAAIvC,OAAOsD,WAStBhR,OAAO8V,KAAKG,OAAO,SAASC,EAAUC,GAClC,IAAID,IAAcA,EAAU9V,UAExB,KADAwV,SAAQC,MAAM,iCAAiCM,EAAe,6BAA6BD,GACrF,GAAIE,OAAM,oFAIpB,OAFAD,GAAe/V,UAAY0B,OAAO0C,OAAO0R,EAAU9V,WACnD+V,EAAe/V,UAAUgD,YAAc+S,EAChCA,GAMXnW,OAAO8V,KAAKO,aAAa,SAAStE,GAE9B4D,OAAOU,aAAatE,IAQxB/R,OAAO8V,KAAKQ,uBAAuB,WAC/B,GAAiDC,SAA7CvW,OAAO8V,KAAKQ,uBAAuBE,MACnC,MAAOxW,QAAO8V,KAAKQ,uBAAuBE,KAE9C,IAAIC,IAAc,CAIlB,KACId,OAAOe,aACHhR,SAAU,WACN+Q,GAAc,GAElBE,KAAM,GAAIC,OACX,KACL,MAAOzN,GACLsN,GAAY,EAGhB,MADAzW,QAAO8V,KAAKQ,uBAAuBE,OAAOC,EACnCzW,OAAO8V,KAAKQ,uBAAuBE,OAG9CxW,OAAO8V,KAAKQ,uBAAuBE,MAAMD,OAQzCvW,OAAO8V,KAAKe,MAAM,SAASlW,GAC1B,IAAGI,MAAM2H,QAAQ/H,IAA4B,gBAAZ,GAOhC,MAAOA,EAND,KACI,MAAOmW,MAAKjI,MAAMiI,KAAKC,UAAUpW,IACnC,MAAOwI,GACLyM,QAAQ/D,IAAI1I,KAexBnJ,OAAO8V,KAAKkB,iBAAiB,SAASC,EAASC,EAAQC,GAEnD,MADAA,GAAMA,GAAS,SAAS3M,EAAE4M,GAAK,MAAO5M,KAAI4M,GACnCF,EAAQxL,MAAM,SAAS2L,GAC1B,MAAOJ,GAAStL,KAAK,SAAS2L,GAC1B,MAAOH,GAAMG,EAAID,QAc7BrX,OAAO8V,KAAKyB,kBAAkB,SAASN,EAASC,EAAQC,GACpDA,EAAMA,GAAS,SAAS3M,EAAE4M,GAAK,MAAO5M,KAAI4M,EAE1C,KAAI,GAAII,KAAaN,GACjB,IAAIC,EAAMF,EAASO,GAAWN,EAAQM,IAClC,OAAO,CAGf,QAAO,GAGXxX,OAAO8V,KAAK2B,iBAAiB,SAASC,GAClCA,EAAQA,GAAS/B,OAAOgC,SAASC,MAIpC,KAHG,GAECxH,GAFGyH,KACHC,EAAM,wBAEJ1H,EAAM0H,EAAMzH,KAAKqH,IACtBG,EAAOzH,EAAM,IAAI2H,mBAAmB3H,EAAM,GAExC,OAAOyH,IAGX7X,OAAO8V,KAAKkC,KAAO,SAAUC,GAEzB,GAAIjO,GAAS,GAAIhK,QAAOC,YACpBiY,EAAU,GAAIC,eAsBlB,OApBAD,GAAQE,mBAAqB,WACE,IAAvBF,EAAQG,aAIW,MAAnBH,EAAQpX,OACRkJ,EAAOnJ,QAAQ,UAAWiW,KAAKjI,MAAM3O,KAAKoY,eAE1CtO,EAAOnJ,QAAQ,UAAWX,KAAKqY,WAAYrY,KAAKoY,gBAGxDJ,EAAQM,KAAKP,EAAO7O,OAAQ6O,EAAOQ,MAAM,GAEpB,SAAlBR,EAAO7O,QACN8O,EAAQQ,KAAKT,EAAO3G,MAExB4G,EAAQS,iBAAiB,eAAgB,oBACzCT,EAAQS,iBAAiB,gBAAiB,YAC1CT,EAAQQ,OAED1O,EAEX,IAAIhK,QAAOA,UAWXA,QAAO4Y,OAAO,SAASX,GACtBA,EAAOA,MACP/X,KAAK2Y,QAAQ,UACb3Y,KAAK4Y,kBACL5Y,KAAK6Y,QAAQd,EAAOc,OACpB,IAAIvO,GAAEjH,SAASC,cAAc,IAC7BgH,GAAEiO,KAAOvY,KAAK6Y,QACd7Y,KAAK8Y,WAAWxO,EAAEyO,SAAW,KAAOzO,EAAE0O,SACnC1O,EAAE2O,OACJjZ,KAAK8Y,YAAa,IAAMxO,EAAE2O,MAG3BjZ,KAAKkZ,SAAU,YAAcnB,GAAUA,EAAOmB,UAAW,EACzDlZ,KAAKmZ,cAAc,EACnBnZ,KAAK0U,OAAO,GAAI5U,QAAO2U,MACvBzU,KAAK0U,OAAOU,WAAWpV,MACvBA,KAAKoZ,gBAAgB,EACrBpZ,KAAKqZ,cAAc,EACnBrZ,KAAKsZ,YAAY,EACjBtZ,KAAKuZ,UAAU,EACfvZ,KAAKwZ,UAAU1Z,OAAO8V,KAAK7F,MACxB/P,KAAKyV,OAASA,MACjB,IAAInV,GAAKN,IAENA,MAAKkZ,UACPlZ,KAAKyZ,WAGHzZ,KAAK0Z,mBAAqB,SAAS9E,GAC/B,GAAGA,EAAM+E,SAAWrZ,EAAKwY,WAGzB,IACI,GAAIc,GAAQhF,EAAMxD,IACM,iBAAd,KACNwI,EAAQhD,KAAKjI,MAAMiG,EAAMxD,OAE7B9Q,EAAKuZ,QAAQD,GACbtZ,EAAK+Y,eAAoC,EAApBzE,EAAMxD,KAAKtI,OAChCxI,EAAK8Y,kBACP,MAAMnQ,MAKfwM,OAAOqE,iBAAiB,UAAW9Z,KAAK0Z,oBAAoB,GAEzD1Z,KAAK+Z,sBAEL/Z,KAAK2U,GAAG,YAAY,WAChBrU,EAAKyZ,mBAAmB5O,QAAQ,SAAS6O,GACrCtE,QAAQ/D,IAAI,uBAAuBqI,GACnC1Z,EAAKkY,KAAKwB,EAAEC,OAAOD,EAAE3Z,SAAS2Z,EAAEE,WAEpC5Z,EAAKyZ,mBAAmB,QAYhCja,OAAO4Y,OAAOxY,UAAU2Z,QAAQ,SAASM,GAClCA,EAAOC,SAAWpa,KAAK4Y,eAAeuB,EAAOC,SACvCpa,KAAK4Y,eAAeuB,EAAOC,SAASD,IACrCna,KAAKqa,eAAeF,EAAOC,SAG/Bpa,KAAK0U,OAAOM,QAAQ,UAAUmF,IAWtCra,OAAO4Y,OAAOxY,UAAUsY,KAAK,SAASyB,EAAO5Z,EAASia,GAClD,GAAIJ,GAASI,CACb,KAAKta,KAAKua,eAA6B,cAAZN,EAAOO,IAQ9B,MANA9E,SAAQ/D,IAAI,4BAA4BjR,WACxCV,KAAK+Z,mBAAmB3R,MACpB6R,OAAUA,EACV5Z,SAAYA,EACZ6Z,QAAWA,IAERA,CAEX,IAAInK,IAAI,GAAIvC,OAAOsD,UAClB2J,EAAG,KAAKza,KAAKmZ,gBACbgB,GACHO,IAAK,EACLzV,IAAKjF,KAAK2Y,QACVgC,MAAOF,EACPG,KAAM7K,EAGP,KAAI,GAAIgC,KAAKkI,GACZE,EAAOpI,GAAGkI,EAAOlI,EAGf1R,KACFL,KAAK4Y,eAAe6B,GAAIpa,EAEzB,IAAI+Q,GAAK+I,CAOT,OANQra,QAAO8V,KAAKQ,2BACbhF,EAAKwF,KAAKC,UAAUsD,IAE3Bna,KAAK6a,KAAKrE,YAAYpF,EAAK,KAC3BpR,KAAKuZ,WAAWnI,EAAKtI,OACrB9I,KAAKsZ,cACEa,GAERra,OAAO4Y,OAAOxY,UAAUqa,YAAY,WACnC,MAAwB,YAAjBva,KAAK2Y,SAMb7Y,OAAO4Y,OAAOxY,UAAUma,eAAe,SAASM,GAC5C,GAAI3Z,IAAQ,CAKZ,OAJI2Z,WACO3a,MAAK4Y,eAAe+B,GAC3B3Z,GAAQ,GAELA,GAIXlB,OAAO4Y,OAAOxY,UAAUyU,GAAG,SAASC,EAAMvU,GACzC,MAAW,cAARuU,GAAuB5U,KAAKua,kBAC9Bla,GAASL,MAGHA,KAAK0U,OAAOC,GAAGnU,MAAMR,KAAK0U,OAAOhU,YAGzCZ,OAAO4Y,OAAOxY,UAAU6U,IAAI,WACxB,MAAO/U,MAAK0U,OAAOK,IAAIvU,MAAMR,KAAK0U,OAAOhU,YAG7CZ,OAAO4Y,OAAOxY,UAAU4a,WAAW,WAC/B9a,KAAK4Y,kBACLnD,OAAOsF,oBAAoB,UAAU/a,KAAK0Z,oBAAmB,GAC1D1Z,KAAK0E,QACJrB,SAASuB,KAAKQ,YAAYpF,KAAK0E,SAIvC5E,OAAO4Y,OAAOxY,UAAU8a,iBAAiB,SAASnC,GAC9C,GAAIvY,GAAKN,KACLib,EAAiB,WACjB3a,EAAKoE,OAAOrB,SAASC,cAAc,UACnChD,EAAKoE,OAAOO,IAAI4T,EAAQ,oBACxBvY,EAAKoE,OAAOwW,OAAO,EACnB5a,EAAKoE,OAAOyW,MAAM,EAClB7a,EAAKoE,OAAOI,MAAMsW,YAAa,UAAW,OAAQ,aAClD9a,EAAKoE,OAAOoV,iBAAiB,OAAO,WAAaxZ,EAAK+a,mBAAoB,GAC1EhY,SAASuB,KAAKI,YAAY1E,EAAKoE,QAC/BpE,EAAKua,KAAKva,EAAKoE,OAAOS,cAIC,cAAxB9B,SAAS8U,WACR8C,IAEAxF,OAAOqE,iBAAiB,OAAOmB,GAAiB,IAIxDnb,OAAO4Y,OAAOxY,UAAUuZ,SAAS,WAM7BzZ,KAAKgb,iBAAiBhb,KAAK6Y,UAI/B/Y,OAAO4Y,OAAOxY,UAAUmb,eAAe,WAEtC,GAAI/a,GAAKN,IACTA,MAAKwY,MAAMgC,IAAI,cAAc,SAASZ,GAG/B,MAFNtZ,GAAKqY,QAAQiB,EAAQY,IACrBla,EAAKoU,OAAOM,QAAQ,YAAY1U,GACnB","sourcesContent":["/** @namespace */\nvar ozpIwc=ozpIwc || {};\n\n\n/**\n * A deferred action, but not in the sense of the Javascript standard.\n * @class\n */\nozpIwc.AsyncAction=function() {\n\tthis.callbacks={};\n};\n\nozpIwc.AsyncAction.prototype.when=function(state,callback,self) {\n    self=self || this;\n\t\n\tif(this.resolution === state) {\n\t\tcallback.apply(self,this.value);\n\t} else {\n\t\tthis.callbacks[state]=function() { return callback.apply(self,arguments); };\n\t}\n\treturn this;\n};\n\n\nozpIwc.AsyncAction.prototype.resolve=function(status) {\n\tif(this.resolution) {\n\t\tthrow \"Cannot resolve an already resolved AsyncAction\";\n\t}\n\tvar callback=this.callbacks[status];\n\tthis.resolution=status;\n\tthis.value=Array.prototype.slice.call(arguments,1);\n\t\n\tif(callback) {\n\t\tcallback.apply(this,this.value);\n\t}\n\treturn this;\n};\n\nozpIwc.AsyncAction.prototype.success=function(callback,self) {\n\treturn this.when(\"success\",callback,self);\n};\n\nozpIwc.AsyncAction.prototype.failure=function(callback,self) {\n\treturn this.when(\"failure\",callback,self);\n};\r\n/*!\r\n * https://github.com/es-shims/es5-shim\r\n * @license es5-shim Copyright 2009-2014 by contributors, MIT License\r\n * see https://github.com/es-shims/es5-shim/blob/master/LICENSE\r\n */\r\n\r\n// vim: ts=4 sts=4 sw=4 expandtab\r\n\r\n//Add semicolon to prevent IIFE from being passed as argument to concated code.\r\n;\r\n\r\n// UMD (Universal Module Definition)\r\n// see https://github.com/umdjs/umd/blob/master/returnExports.js\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(factory);\r\n    } else if (typeof exports === 'object') {\r\n        // Node. Does not work with strict CommonJS, but\r\n        // only CommonJS-like enviroments that support module.exports,\r\n        // like Node.\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals (root is window)\r\n        root.returnExports = factory();\r\n  }\r\n}(this, function () {\r\n\r\nvar call = Function.prototype.call;\r\nvar prototypeOfObject = Object.prototype;\r\nvar owns = call.bind(prototypeOfObject.hasOwnProperty);\r\n\r\n// If JS engine supports accessors creating shortcuts.\r\nvar defineGetter;\r\nvar defineSetter;\r\nvar lookupGetter;\r\nvar lookupSetter;\r\nvar supportsAccessors = owns(prototypeOfObject, \"__defineGetter__\");\r\nif (supportsAccessors) {\r\n    defineGetter = call.bind(prototypeOfObject.__defineGetter__);\r\n    defineSetter = call.bind(prototypeOfObject.__defineSetter__);\r\n    lookupGetter = call.bind(prototypeOfObject.__lookupGetter__);\r\n    lookupSetter = call.bind(prototypeOfObject.__lookupSetter__);\r\n}\r\n\r\n// ES5 15.2.3.2\r\n// http://es5.github.com/#x15.2.3.2\r\nif (!Object.getPrototypeOf) {\r\n    // https://github.com/es-shims/es5-shim/issues#issue/2\r\n    // http://ejohn.org/blog/objectgetprototypeof/\r\n    // recommended by fschaefer on github\r\n    //\r\n    // sure, and webreflection says ^_^\r\n    // ... this will nerever possibly return null\r\n    // ... Opera Mini breaks here with infinite loops\r\n    Object.getPrototypeOf = function getPrototypeOf(object) {\r\n        var proto = object.__proto__;\r\n        if (proto || proto === null) {\r\n            return proto;\r\n        } else if (object.constructor) {\r\n            return object.constructor.prototype;\r\n        } else {\r\n            return prototypeOfObject;\r\n        }\r\n    };\r\n}\r\n\r\n//ES5 15.2.3.3\r\n//http://es5.github.com/#x15.2.3.3\r\n\r\nfunction doesGetOwnPropertyDescriptorWork(object) {\r\n    try {\r\n        object.sentinel = 0;\r\n        return Object.getOwnPropertyDescriptor(\r\n                object,\r\n                \"sentinel\"\r\n        ).value === 0;\r\n    } catch (exception) {\r\n        // returns falsy\r\n    }\r\n}\r\n\r\n//check whether getOwnPropertyDescriptor works if it's given. Otherwise,\r\n//shim partially.\r\nif (Object.defineProperty) {\r\n    var getOwnPropertyDescriptorWorksOnObject = doesGetOwnPropertyDescriptorWork({});\r\n    var getOwnPropertyDescriptorWorksOnDom = typeof document === \"undefined\" ||\r\n    doesGetOwnPropertyDescriptorWork(document.createElement(\"div\"));\r\n    if (!getOwnPropertyDescriptorWorksOnDom || !getOwnPropertyDescriptorWorksOnObject) {\r\n        var getOwnPropertyDescriptorFallback = Object.getOwnPropertyDescriptor;\r\n    }\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor || getOwnPropertyDescriptorFallback) {\r\n    var ERR_NON_OBJECT = \"Object.getOwnPropertyDescriptor called on a non-object: \";\r\n\r\n    Object.getOwnPropertyDescriptor = function getOwnPropertyDescriptor(object, property) {\r\n        if ((typeof object !== \"object\" && typeof object !== \"function\") || object === null) {\r\n            throw new TypeError(ERR_NON_OBJECT + object);\r\n        }\r\n\r\n        // make a valiant attempt to use the real getOwnPropertyDescriptor\r\n        // for I8's DOM elements.\r\n        if (getOwnPropertyDescriptorFallback) {\r\n            try {\r\n                return getOwnPropertyDescriptorFallback.call(Object, object, property);\r\n            } catch (exception) {\r\n                // try the shim if the real one doesn't work\r\n            }\r\n        }\r\n\r\n        // If object does not owns property return undefined immediately.\r\n        if (!owns(object, property)) {\r\n            return;\r\n        }\r\n\r\n        // If object has a property then it's for sure both `enumerable` and\r\n        // `configurable`.\r\n        var descriptor =  { enumerable: true, configurable: true };\r\n\r\n        // If JS engine supports accessor properties then property may be a\r\n        // getter or setter.\r\n        if (supportsAccessors) {\r\n            // Unfortunately `__lookupGetter__` will return a getter even\r\n            // if object has own non getter property along with a same named\r\n            // inherited getter. To avoid misbehavior we temporary remove\r\n            // `__proto__` so that `__lookupGetter__` will return getter only\r\n            // if it's owned by an object.\r\n            var prototype = object.__proto__;\r\n            var notPrototypeOfObject = object !== prototypeOfObject;\r\n            // avoid recursion problem, breaking in Opera Mini when\r\n            // Object.getOwnPropertyDescriptor(Object.prototype, 'toString')\r\n            // or any other Object.prototype accessor\r\n            if (notPrototypeOfObject) {\r\n                object.__proto__ = prototypeOfObject;\r\n            }\r\n\r\n            var getter = lookupGetter(object, property);\r\n            var setter = lookupSetter(object, property);\r\n\r\n            if (notPrototypeOfObject) {\r\n                // Once we have getter and setter we can put values back.\r\n                object.__proto__ = prototype;\r\n            }\r\n\r\n            if (getter || setter) {\r\n                if (getter) {\r\n                    descriptor.get = getter;\r\n                }\r\n                if (setter) {\r\n                    descriptor.set = setter;\r\n                }\r\n                // If it was accessor property we're done and return here\r\n                // in order to avoid adding `value` to the descriptor.\r\n                return descriptor;\r\n            }\r\n        }\r\n\r\n        // If we got this far we know that object has an own property that is\r\n        // not an accessor so we set it as a value and return descriptor.\r\n        descriptor.value = object[property];\r\n        descriptor.writable = true;\r\n        return descriptor;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.4\r\n// http://es5.github.com/#x15.2.3.4\r\nif (!Object.getOwnPropertyNames) {\r\n    Object.getOwnPropertyNames = function getOwnPropertyNames(object) {\r\n        return Object.keys(object);\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.5\r\n// http://es5.github.com/#x15.2.3.5\r\nif (!Object.create) {\r\n\r\n    // Contributed by Brandon Benvie, October, 2012\r\n    var createEmpty;\r\n    var supportsProto = !({__proto__:null} instanceof Object);\r\n                        // the following produces false positives\r\n                        // in Opera Mini => not a reliable check\r\n                        // Object.prototype.__proto__ === null\r\n    if (supportsProto || typeof document === 'undefined') {\r\n        createEmpty = function () {\r\n            return { \"__proto__\": null };\r\n        };\r\n    } else {\r\n        // In old IE __proto__ can't be used to manually set `null`, nor does\r\n        // any other method exist to make an object that inherits from nothing,\r\n        // aside from Object.prototype itself. Instead, create a new global\r\n        // object and *steal* its Object.prototype and strip it bare. This is\r\n        // used as the prototype to create nullary objects.\r\n        createEmpty = function () {\r\n            var iframe = document.createElement('iframe');\r\n            var parent = document.body || document.documentElement;\r\n            iframe.style.display = 'none';\r\n            parent.appendChild(iframe);\r\n            iframe.src = 'javascript:';\r\n            var empty = iframe.contentWindow.Object.prototype;\r\n            parent.removeChild(iframe);\r\n            iframe = null;\r\n            delete empty.constructor;\r\n            delete empty.hasOwnProperty;\r\n            delete empty.propertyIsEnumerable;\r\n            delete empty.isPrototypeOf;\r\n            delete empty.toLocaleString;\r\n            delete empty.toString;\r\n            delete empty.valueOf;\r\n            empty.__proto__ = null;\r\n\r\n            function Empty() {}\r\n            Empty.prototype = empty;\r\n            // short-circuit future calls\r\n            createEmpty = function () {\r\n                return new Empty();\r\n            };\r\n            return new Empty();\r\n        };\r\n    }\r\n\r\n    Object.create = function create(prototype, properties) {\r\n\r\n        var object;\r\n        function Type() {}  // An empty constructor.\r\n\r\n        if (prototype === null) {\r\n            object = createEmpty();\r\n        } else {\r\n            if (typeof prototype !== \"object\" && typeof prototype !== \"function\") {\r\n                // In the native implementation `parent` can be `null`\r\n                // OR *any* `instanceof Object`  (Object|Function|Array|RegExp|etc)\r\n                // Use `typeof` tho, b/c in old IE, DOM elements are not `instanceof Object`\r\n                // like they are in modern browsers. Using `Object.create` on DOM elements\r\n                // is...err...probably inappropriate, but the native version allows for it.\r\n                throw new TypeError(\"Object prototype may only be an Object or null\"); // same msg as Chrome\r\n            }\r\n            Type.prototype = prototype;\r\n            object = new Type();\r\n            // IE has no built-in implementation of `Object.getPrototypeOf`\r\n            // neither `__proto__`, but this manually setting `__proto__` will\r\n            // guarantee that `Object.getPrototypeOf` will work as expected with\r\n            // objects created using `Object.create`\r\n            object.__proto__ = prototype;\r\n        }\r\n\r\n        if (properties !== void 0) {\r\n            Object.defineProperties(object, properties);\r\n        }\r\n\r\n        return object;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.6\r\n// http://es5.github.com/#x15.2.3.6\r\n\r\n// Patch for WebKit and IE8 standard mode\r\n// Designed by hax <hax.github.com>\r\n// related issue: https://github.com/es-shims/es5-shim/issues#issue/5\r\n// IE8 Reference:\r\n//     http://msdn.microsoft.com/en-us/library/dd282900.aspx\r\n//     http://msdn.microsoft.com/en-us/library/dd229916.aspx\r\n// WebKit Bugs:\r\n//     https://bugs.webkit.org/show_bug.cgi?id=36423\r\n\r\nfunction doesDefinePropertyWork(object) {\r\n    try {\r\n        Object.defineProperty(object, \"sentinel\", {});\r\n        return \"sentinel\" in object;\r\n    } catch (exception) {\r\n        // returns falsy\r\n    }\r\n}\r\n\r\n// check whether defineProperty works if it's given. Otherwise,\r\n// shim partially.\r\nif (Object.defineProperty) {\r\n    var definePropertyWorksOnObject = doesDefinePropertyWork({});\r\n    var definePropertyWorksOnDom = typeof document === \"undefined\" ||\r\n        doesDefinePropertyWork(document.createElement(\"div\"));\r\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) {\r\n        var definePropertyFallback = Object.defineProperty,\r\n            definePropertiesFallback = Object.defineProperties;\r\n    }\r\n}\r\n\r\nif (!Object.defineProperty || definePropertyFallback) {\r\n    var ERR_NON_OBJECT_DESCRIPTOR = \"Property description must be an object: \";\r\n    var ERR_NON_OBJECT_TARGET = \"Object.defineProperty called on non-object: \"\r\n    var ERR_ACCESSORS_NOT_SUPPORTED = \"getters & setters can not be defined \" +\r\n                                      \"on this javascript engine\";\r\n\r\n    Object.defineProperty = function defineProperty(object, property, descriptor) {\r\n        if ((typeof object !== \"object\" && typeof object !== \"function\") || object === null) {\r\n            throw new TypeError(ERR_NON_OBJECT_TARGET + object);\r\n        }\r\n        if ((typeof descriptor !== \"object\" && typeof descriptor !== \"function\") || descriptor === null) {\r\n            throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);\r\n        }\r\n        // make a valiant attempt to use the real defineProperty\r\n        // for I8's DOM elements.\r\n        if (definePropertyFallback) {\r\n            try {\r\n                return definePropertyFallback.call(Object, object, property, descriptor);\r\n            } catch (exception) {\r\n                // try the shim if the real one doesn't work\r\n            }\r\n        }\r\n\r\n        // If it's a data property.\r\n        if (owns(descriptor, \"value\")) {\r\n            // fail silently if \"writable\", \"enumerable\", or \"configurable\"\r\n            // are requested but not supported\r\n            /*\r\n            // alternate approach:\r\n            if ( // can't implement these features; allow false but not true\r\n                !(owns(descriptor, \"writable\") ? descriptor.writable : true) ||\r\n                !(owns(descriptor, \"enumerable\") ? descriptor.enumerable : true) ||\r\n                !(owns(descriptor, \"configurable\") ? descriptor.configurable : true)\r\n            )\r\n                throw new RangeError(\r\n                    \"This implementation of Object.defineProperty does not \" +\r\n                    \"support configurable, enumerable, or writable.\"\r\n                );\r\n            */\r\n\r\n            if (supportsAccessors && (lookupGetter(object, property) ||\r\n                                      lookupSetter(object, property)))\r\n            {\r\n                // As accessors are supported only on engines implementing\r\n                // `__proto__` we can safely override `__proto__` while defining\r\n                // a property to make sure that we don't hit an inherited\r\n                // accessor.\r\n                var prototype = object.__proto__;\r\n                object.__proto__ = prototypeOfObject;\r\n                // Deleting a property anyway since getter / setter may be\r\n                // defined on object itself.\r\n                delete object[property];\r\n                object[property] = descriptor.value;\r\n                // Setting original `__proto__` back now.\r\n                object.__proto__ = prototype;\r\n            } else {\r\n                object[property] = descriptor.value;\r\n            }\r\n        } else {\r\n            if (!supportsAccessors) {\r\n                throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\r\n            }\r\n            // If we got that far then getters and setters can be defined !!\r\n            if (owns(descriptor, \"get\")) {\r\n                defineGetter(object, property, descriptor.get);\r\n            }\r\n            if (owns(descriptor, \"set\")) {\r\n                defineSetter(object, property, descriptor.set);\r\n            }\r\n        }\r\n        return object;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.7\r\n// http://es5.github.com/#x15.2.3.7\r\nif (!Object.defineProperties || definePropertiesFallback) {\r\n    Object.defineProperties = function defineProperties(object, properties) {\r\n        // make a valiant attempt to use the real defineProperties\r\n        if (definePropertiesFallback) {\r\n            try {\r\n                return definePropertiesFallback.call(Object, object, properties);\r\n            } catch (exception) {\r\n                // try the shim if the real one doesn't work\r\n            }\r\n        }\r\n\r\n        for (var property in properties) {\r\n            if (owns(properties, property) && property !== \"__proto__\") {\r\n                Object.defineProperty(object, property, properties[property]);\r\n            }\r\n        }\r\n        return object;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.8\r\n// http://es5.github.com/#x15.2.3.8\r\nif (!Object.seal) {\r\n    Object.seal = function seal(object) {\r\n        // this is misleading and breaks feature-detection, but\r\n        // allows \"securable\" code to \"gracefully\" degrade to working\r\n        // but insecure code.\r\n        return object;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.9\r\n// http://es5.github.com/#x15.2.3.9\r\nif (!Object.freeze) {\r\n    Object.freeze = function freeze(object) {\r\n        // this is misleading and breaks feature-detection, but\r\n        // allows \"securable\" code to \"gracefully\" degrade to working\r\n        // but insecure code.\r\n        return object;\r\n    };\r\n}\r\n\r\n// detect a Rhino bug and patch it\r\ntry {\r\n    Object.freeze(function () {});\r\n} catch (exception) {\r\n    Object.freeze = (function freeze(freezeObject) {\r\n        return function freeze(object) {\r\n            if (typeof object === \"function\") {\r\n                return object;\r\n            } else {\r\n                return freezeObject(object);\r\n            }\r\n        };\r\n    })(Object.freeze);\r\n}\r\n\r\n// ES5 15.2.3.10\r\n// http://es5.github.com/#x15.2.3.10\r\nif (!Object.preventExtensions) {\r\n    Object.preventExtensions = function preventExtensions(object) {\r\n        // this is misleading and breaks feature-detection, but\r\n        // allows \"securable\" code to \"gracefully\" degrade to working\r\n        // but insecure code.\r\n        return object;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.11\r\n// http://es5.github.com/#x15.2.3.11\r\nif (!Object.isSealed) {\r\n    Object.isSealed = function isSealed(object) {\r\n        return false;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.12\r\n// http://es5.github.com/#x15.2.3.12\r\nif (!Object.isFrozen) {\r\n    Object.isFrozen = function isFrozen(object) {\r\n        return false;\r\n    };\r\n}\r\n\r\n// ES5 15.2.3.13\r\n// http://es5.github.com/#x15.2.3.13\r\nif (!Object.isExtensible) {\r\n    Object.isExtensible = function isExtensible(object) {\r\n        // 1. If Type(O) is not Object throw a TypeError exception.\r\n        if (Object(object) !== object) {\r\n            throw new TypeError(); // TODO message\r\n        }\r\n        // 2. Return the Boolean value of the [[Extensible]] internal property of O.\r\n        var name = '';\r\n        while (owns(object, name)) {\r\n            name += '?';\r\n        }\r\n        object[name] = true;\r\n        var returnValue = owns(object, name);\r\n        delete object[name];\r\n        return returnValue;\r\n    };\r\n}\r\n\r\n}));\r\n\r\n\r\n/*!\r\n * https://github.com/es-shims/es5-shim\r\n * @license es5-shim Copyright 2009-2014 by contributors, MIT License\r\n * see https://github.com/es-shims/es5-shim/blob/master/LICENSE\r\n */\r\n\r\n// vim: ts=4 sts=4 sw=4 expandtab\r\n\r\n//Add semicolon to prevent IIFE from being passed as argument to concated code.\r\n;\r\n\r\n// UMD (Universal Module Definition)\r\n// see https://github.com/umdjs/umd/blob/master/returnExports.js\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(factory);\r\n    } else if (typeof exports === 'object') {\r\n        // Node. Does not work with strict CommonJS, but\r\n        // only CommonJS-like enviroments that support module.exports,\r\n        // like Node.\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals (root is window)\r\n        root.returnExports = factory();\r\n    }\r\n}(this, function () {\r\n\r\n/**\r\n * Brings an environment as close to ECMAScript 5 compliance\r\n * as is possible with the facilities of erstwhile engines.\r\n *\r\n * Annotated ES5: http://es5.github.com/ (specific links below)\r\n * ES5 Spec: http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf\r\n * Required reading: http://javascriptweblog.wordpress.com/2011/12/05/extending-javascript-natives/\r\n */\r\n\r\n// Shortcut to an often accessed properties, in order to avoid multiple\r\n// dereference that costs universally.\r\nvar ArrayPrototype = Array.prototype;\r\nvar ObjectPrototype = Object.prototype;\r\nvar FunctionPrototype = Function.prototype;\r\nvar StringPrototype = String.prototype;\r\nvar NumberPrototype = Number.prototype;\r\nvar array_slice = ArrayPrototype.slice;\r\nvar array_splice = ArrayPrototype.splice;\r\nvar array_push = ArrayPrototype.push;\r\nvar array_unshift = ArrayPrototype.unshift;\r\nvar call = FunctionPrototype.call;\r\n\r\n// Having a toString local variable name breaks in Opera so use _toString.\r\nvar _toString = ObjectPrototype.toString;\r\n\r\nvar isFunction = function (val) {\r\n    return ObjectPrototype.toString.call(val) === '[object Function]';\r\n};\r\nvar isRegex = function (val) {\r\n    return ObjectPrototype.toString.call(val) === '[object RegExp]';\r\n};\r\nvar isArray = function isArray(obj) {\r\n    return _toString.call(obj) === \"[object Array]\";\r\n};\r\nvar isString = function isString(obj) {\r\n    return _toString.call(obj) === \"[object String]\";\r\n};\r\nvar isArguments = function isArguments(value) {\r\n    var str = _toString.call(value);\r\n    var isArgs = str === '[object Arguments]';\r\n    if (!isArgs) {\r\n        isArgs = !isArray(value)\r\n            && value !== null\r\n            && typeof value === 'object'\r\n            && typeof value.length === 'number'\r\n            && value.length >= 0\r\n            && isFunction(value.callee);\r\n    }\r\n    return isArgs;\r\n};\r\n\r\nvar supportsDescriptors = Object.defineProperty && (function () {\r\n    try {\r\n        Object.defineProperty({}, 'x', {});\r\n        return true;\r\n    } catch (e) { /* this is ES3 */\r\n        return false;\r\n    }\r\n}());\r\n\r\n// Define configurable, writable and non-enumerable props\r\n// if they don't exist.\r\nvar defineProperty;\r\nif (supportsDescriptors) {\r\n    defineProperty = function (object, name, method, forceAssign) {\r\n        if (!forceAssign && (name in object)) { return; }\r\n        Object.defineProperty(object, name, {\r\n            configurable: true,\r\n            enumerable: false,\r\n            writable: true,\r\n            value: method\r\n        });\r\n    };\r\n} else {\r\n    defineProperty = function (object, name, method, forceAssign) {\r\n        if (!forceAssign && (name in object)) { return; }\r\n        object[name] = method;\r\n    };\r\n}\r\nvar defineProperties = function (object, map, forceAssign) {\r\n    for (var name in map) {\r\n        if (ObjectPrototype.hasOwnProperty.call(map, name)) {\r\n          defineProperty(object, name, map[name], forceAssign);\r\n        }\r\n    }\r\n};\r\n\r\n//\r\n// Util\r\n// ======\r\n//\r\n\r\n// ES5 9.4\r\n// http://es5.github.com/#x9.4\r\n// http://jsperf.com/to-integer\r\n\r\nfunction toInteger(n) {\r\n    n = +n;\r\n    if (n !== n) { // isNaN\r\n        n = 0;\r\n    } else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0)) {\r\n        n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n    }\r\n    return n;\r\n}\r\n\r\nfunction isPrimitive(input) {\r\n    var type = typeof input;\r\n    return (\r\n        input === null ||\r\n        type === \"undefined\" ||\r\n        type === \"boolean\" ||\r\n        type === \"number\" ||\r\n        type === \"string\"\r\n    );\r\n}\r\n\r\nfunction toPrimitive(input) {\r\n    var val, valueOf, toStr;\r\n    if (isPrimitive(input)) {\r\n        return input;\r\n    }\r\n    valueOf = input.valueOf;\r\n    if (isFunction(valueOf)) {\r\n        val = valueOf.call(input);\r\n        if (isPrimitive(val)) {\r\n            return val;\r\n        }\r\n    }\r\n    toStr = input.toString;\r\n    if (isFunction(toStr)) {\r\n        val = toStr.call(input);\r\n        if (isPrimitive(val)) {\r\n            return val;\r\n        }\r\n    }\r\n    throw new TypeError();\r\n}\r\n\r\n// ES5 9.9\r\n// http://es5.github.com/#x9.9\r\nvar toObject = function (o) {\r\n    if (o == null) { // this matches both null and undefined\r\n        throw new TypeError(\"can't convert \" + o + \" to object\");\r\n    }\r\n    return Object(o);\r\n};\r\n\r\nvar ToUint32 = function ToUint32(x) {\r\n    return x >>> 0;\r\n};\r\n\r\n//\r\n// Function\r\n// ========\r\n//\r\n\r\n// ES-5 15.3.4.5\r\n// http://es5.github.com/#x15.3.4.5\r\n\r\nfunction Empty() {}\r\n\r\ndefineProperties(FunctionPrototype, {\r\n    bind: function bind(that) { // .length is 1\r\n        // 1. Let Target be the this value.\r\n        var target = this;\r\n        // 2. If IsCallable(Target) is false, throw a TypeError exception.\r\n        if (!isFunction(target)) {\r\n            throw new TypeError(\"Function.prototype.bind called on incompatible \" + target);\r\n        }\r\n        // 3. Let A be a new (possibly empty) internal list of all of the\r\n        //   argument values provided after thisArg (arg1, arg2 etc), in order.\r\n        // XXX slicedArgs will stand in for \"A\" if used\r\n        var args = array_slice.call(arguments, 1); // for normal call\r\n        // 4. Let F be a new native ECMAScript object.\r\n        // 11. Set the [[Prototype]] internal property of F to the standard\r\n        //   built-in Function prototype object as specified in 15.3.3.1.\r\n        // 12. Set the [[Call]] internal property of F as described in\r\n        //   15.3.4.5.1.\r\n        // 13. Set the [[Construct]] internal property of F as described in\r\n        //   15.3.4.5.2.\r\n        // 14. Set the [[HasInstance]] internal property of F as described in\r\n        //   15.3.4.5.3.\r\n        var binder = function () {\r\n\r\n            if (this instanceof bound) {\r\n                // 15.3.4.5.2 [[Construct]]\r\n                // When the [[Construct]] internal method of a function object,\r\n                // F that was created using the bind function is called with a\r\n                // list of arguments ExtraArgs, the following steps are taken:\r\n                // 1. Let target be the value of F's [[TargetFunction]]\r\n                //   internal property.\r\n                // 2. If target has no [[Construct]] internal method, a\r\n                //   TypeError exception is thrown.\r\n                // 3. Let boundArgs be the value of F's [[BoundArgs]] internal\r\n                //   property.\r\n                // 4. Let args be a new list containing the same values as the\r\n                //   list boundArgs in the same order followed by the same\r\n                //   values as the list ExtraArgs in the same order.\r\n                // 5. Return the result of calling the [[Construct]] internal\r\n                //   method of target providing args as the arguments.\r\n\r\n                var result = target.apply(\r\n                    this,\r\n                    args.concat(array_slice.call(arguments))\r\n                );\r\n                if (Object(result) === result) {\r\n                    return result;\r\n                }\r\n                return this;\r\n\r\n            } else {\r\n                // 15.3.4.5.1 [[Call]]\r\n                // When the [[Call]] internal method of a function object, F,\r\n                // which was created using the bind function is called with a\r\n                // this value and a list of arguments ExtraArgs, the following\r\n                // steps are taken:\r\n                // 1. Let boundArgs be the value of F's [[BoundArgs]] internal\r\n                //   property.\r\n                // 2. Let boundThis be the value of F's [[BoundThis]] internal\r\n                //   property.\r\n                // 3. Let target be the value of F's [[TargetFunction]] internal\r\n                //   property.\r\n                // 4. Let args be a new list containing the same values as the\r\n                //   list boundArgs in the same order followed by the same\r\n                //   values as the list ExtraArgs in the same order.\r\n                // 5. Return the result of calling the [[Call]] internal method\r\n                //   of target providing boundThis as the this value and\r\n                //   providing args as the arguments.\r\n\r\n                // equiv: target.call(this, ...boundArgs, ...args)\r\n                return target.apply(\r\n                    that,\r\n                    args.concat(array_slice.call(arguments))\r\n                );\r\n\r\n            }\r\n\r\n        };\r\n\r\n        // 15. If the [[Class]] internal property of Target is \"Function\", then\r\n        //     a. Let L be the length property of Target minus the length of A.\r\n        //     b. Set the length own property of F to either 0 or L, whichever is\r\n        //       larger.\r\n        // 16. Else set the length own property of F to 0.\r\n\r\n        var boundLength = Math.max(0, target.length - args.length);\r\n\r\n        // 17. Set the attributes of the length own property of F to the values\r\n        //   specified in 15.3.5.1.\r\n        var boundArgs = [];\r\n        for (var i = 0; i < boundLength; i++) {\r\n            boundArgs.push(\"$\" + i);\r\n        }\r\n\r\n        // XXX Build a dynamic function with desired amount of arguments is the only\r\n        // way to set the length property of a function.\r\n        // In environments where Content Security Policies enabled (Chrome extensions,\r\n        // for ex.) all use of eval or Function costructor throws an exception.\r\n        // However in all of these environments Function.prototype.bind exists\r\n        // and so this code will never be executed.\r\n        var bound = Function(\"binder\", \"return function (\" + boundArgs.join(\",\") + \"){return binder.apply(this,arguments)}\")(binder);\r\n\r\n        if (target.prototype) {\r\n            Empty.prototype = target.prototype;\r\n            bound.prototype = new Empty();\r\n            // Clean up dangling references.\r\n            Empty.prototype = null;\r\n        }\r\n\r\n        // TODO\r\n        // 18. Set the [[Extensible]] internal property of F to true.\r\n\r\n        // TODO\r\n        // 19. Let thrower be the [[ThrowTypeError]] function Object (13.2.3).\r\n        // 20. Call the [[DefineOwnProperty]] internal method of F with\r\n        //   arguments \"caller\", PropertyDescriptor {[[Get]]: thrower, [[Set]]:\r\n        //   thrower, [[Enumerable]]: false, [[Configurable]]: false}, and\r\n        //   false.\r\n        // 21. Call the [[DefineOwnProperty]] internal method of F with\r\n        //   arguments \"arguments\", PropertyDescriptor {[[Get]]: thrower,\r\n        //   [[Set]]: thrower, [[Enumerable]]: false, [[Configurable]]: false},\r\n        //   and false.\r\n\r\n        // TODO\r\n        // NOTE Function objects created using Function.prototype.bind do not\r\n        // have a prototype property or the [[Code]], [[FormalParameters]], and\r\n        // [[Scope]] internal properties.\r\n        // XXX can't delete prototype in pure-js.\r\n\r\n        // 22. Return F.\r\n        return bound;\r\n    }\r\n});\r\n\r\n// _Please note: Shortcuts are defined after `Function.prototype.bind` as we\r\n// us it in defining shortcuts.\r\nvar owns = call.bind(ObjectPrototype.hasOwnProperty);\r\n\r\n// If JS engine supports accessors creating shortcuts.\r\nvar defineGetter;\r\nvar defineSetter;\r\nvar lookupGetter;\r\nvar lookupSetter;\r\nvar supportsAccessors;\r\nif ((supportsAccessors = owns(ObjectPrototype, \"__defineGetter__\"))) {\r\n    defineGetter = call.bind(ObjectPrototype.__defineGetter__);\r\n    defineSetter = call.bind(ObjectPrototype.__defineSetter__);\r\n    lookupGetter = call.bind(ObjectPrototype.__lookupGetter__);\r\n    lookupSetter = call.bind(ObjectPrototype.__lookupSetter__);\r\n}\r\n\r\n//\r\n// Array\r\n// =====\r\n//\r\n\r\n// ES5 15.4.4.12\r\n// http://es5.github.com/#x15.4.4.12\r\nvar spliceNoopReturnsEmptyArray = (function () {\r\n    var a = [1, 2];\r\n    var result = a.splice();\r\n    return a.length === 2 && isArray(result) && result.length === 0;\r\n}());\r\ndefineProperties(ArrayPrototype, {\r\n    // Safari 5.0 bug where .splice() returns undefined\r\n    splice: function splice(start, deleteCount) {\r\n        if (arguments.length === 0) {\r\n            return [];\r\n        } else {\r\n            return array_splice.apply(this, arguments);\r\n        }\r\n    }\r\n}, spliceNoopReturnsEmptyArray);\r\n\r\nvar spliceWorksWithEmptyObject = (function () {\r\n    var obj = {};\r\n    ArrayPrototype.splice.call(obj, 0, 0, 1);\r\n    return obj.length === 1;\r\n}());\r\ndefineProperties(ArrayPrototype, {\r\n    splice: function splice(start, deleteCount) {\r\n        if (arguments.length === 0) { return []; }\r\n        var args = arguments;\r\n        this.length = Math.max(toInteger(this.length), 0);\r\n        if (arguments.length > 0 && typeof deleteCount !== 'number') {\r\n            args = array_slice.call(arguments);\r\n            if (args.length < 2) {\r\n                args.push(this.length - start);\r\n            } else {\r\n                args[1] = toInteger(deleteCount);\r\n            }\r\n        }\r\n        return array_splice.apply(this, args);\r\n    }\r\n}, !spliceWorksWithEmptyObject);\r\n\r\n// ES5 15.4.4.12\r\n// http://es5.github.com/#x15.4.4.13\r\n// Return len+argCount.\r\n// [bugfix, ielt8]\r\n// IE < 8 bug: [].unshift(0) === undefined but should be \"1\"\r\nvar hasUnshiftReturnValueBug = [].unshift(0) !== 1;\r\ndefineProperties(ArrayPrototype, {\r\n    unshift: function () {\r\n        array_unshift.apply(this, arguments);\r\n        return this.length;\r\n    }\r\n}, hasUnshiftReturnValueBug);\r\n\r\n// ES5 15.4.3.2\r\n// http://es5.github.com/#x15.4.3.2\r\n// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/isArray\r\ndefineProperties(Array, { isArray: isArray });\r\n\r\n// The IsCallable() check in the Array functions\r\n// has been replaced with a strict check on the\r\n// internal class of the object to trap cases where\r\n// the provided function was actually a regular\r\n// expression literal, which in V8 and\r\n// JavaScriptCore is a typeof \"function\".  Only in\r\n// V8 are regular expression literals permitted as\r\n// reduce parameters, so it is desirable in the\r\n// general case for the shim to match the more\r\n// strict and common behavior of rejecting regular\r\n// expressions.\r\n\r\n// ES5 15.4.4.18\r\n// http://es5.github.com/#x15.4.4.18\r\n// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/array/forEach\r\n\r\n// Check failure of by-index access of string characters (IE < 9)\r\n// and failure of `0 in boxedString` (Rhino)\r\nvar boxedString = Object(\"a\");\r\nvar splitString = boxedString[0] !== \"a\" || !(0 in boxedString);\r\n\r\nvar properlyBoxesContext = function properlyBoxed(method) {\r\n    // Check node 0.6.21 bug where third parameter is not boxed\r\n    var properlyBoxesNonStrict = true;\r\n    var properlyBoxesStrict = true;\r\n    if (method) {\r\n        method.call('foo', function (_, __, context) {\r\n            if (typeof context !== 'object') { properlyBoxesNonStrict = false; }\r\n        });\r\n\r\n        method.call([1], function () {\r\n            'use strict';\r\n            properlyBoxesStrict = typeof this === 'string';\r\n        }, 'x');\r\n    }\r\n    return !!method && properlyBoxesNonStrict && properlyBoxesStrict;\r\n};\r\n\r\ndefineProperties(ArrayPrototype, {\r\n    forEach: function forEach(fun /*, thisp*/) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            thisp = arguments[1],\r\n            i = -1,\r\n            length = self.length >>> 0;\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(); // TODO message\r\n        }\r\n\r\n        while (++i < length) {\r\n            if (i in self) {\r\n                // Invoke the callback function with call, passing arguments:\r\n                // context, property value, property key, thisArg object\r\n                // context\r\n                fun.call(thisp, self[i], i, object);\r\n            }\r\n        }\r\n    }\r\n}, !properlyBoxesContext(ArrayPrototype.forEach));\r\n\r\n// ES5 15.4.4.19\r\n// http://es5.github.com/#x15.4.4.19\r\n// https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/map\r\ndefineProperties(ArrayPrototype, {\r\n    map: function map(fun /*, thisp*/) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            length = self.length >>> 0,\r\n            result = Array(length),\r\n            thisp = arguments[1];\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(fun + \" is not a function\");\r\n        }\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (i in self) {\r\n                result[i] = fun.call(thisp, self[i], i, object);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n}, !properlyBoxesContext(ArrayPrototype.map));\r\n\r\n// ES5 15.4.4.20\r\n// http://es5.github.com/#x15.4.4.20\r\n// https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/filter\r\ndefineProperties(ArrayPrototype, {\r\n    filter: function filter(fun /*, thisp */) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            length = self.length >>> 0,\r\n            result = [],\r\n            value,\r\n            thisp = arguments[1];\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(fun + \" is not a function\");\r\n        }\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (i in self) {\r\n                value = self[i];\r\n                if (fun.call(thisp, value, i, object)) {\r\n                    result.push(value);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n}, !properlyBoxesContext(ArrayPrototype.filter));\r\n\r\n// ES5 15.4.4.16\r\n// http://es5.github.com/#x15.4.4.16\r\n// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/every\r\ndefineProperties(ArrayPrototype, {\r\n    every: function every(fun /*, thisp */) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            length = self.length >>> 0,\r\n            thisp = arguments[1];\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(fun + \" is not a function\");\r\n        }\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (i in self && !fun.call(thisp, self[i], i, object)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}, !properlyBoxesContext(ArrayPrototype.every));\r\n\r\n// ES5 15.4.4.17\r\n// http://es5.github.com/#x15.4.4.17\r\n// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/some\r\ndefineProperties(ArrayPrototype, {\r\n    some: function some(fun /*, thisp */) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            length = self.length >>> 0,\r\n            thisp = arguments[1];\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(fun + \" is not a function\");\r\n        }\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (i in self && fun.call(thisp, self[i], i, object)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}, !properlyBoxesContext(ArrayPrototype.some));\r\n\r\n// ES5 15.4.4.21\r\n// http://es5.github.com/#x15.4.4.21\r\n// https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/reduce\r\nvar reduceCoercesToObject = false;\r\nif (ArrayPrototype.reduce) {\r\n    reduceCoercesToObject = typeof ArrayPrototype.reduce.call('es5', function (_, __, ___, list) { return list; }) === 'object';\r\n}\r\ndefineProperties(ArrayPrototype, {\r\n    reduce: function reduce(fun /*, initial*/) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            length = self.length >>> 0;\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(fun + \" is not a function\");\r\n        }\r\n\r\n        // no value to return if no initial value and an empty array\r\n        if (!length && arguments.length === 1) {\r\n            throw new TypeError(\"reduce of empty array with no initial value\");\r\n        }\r\n\r\n        var i = 0;\r\n        var result;\r\n        if (arguments.length >= 2) {\r\n            result = arguments[1];\r\n        } else {\r\n            do {\r\n                if (i in self) {\r\n                    result = self[i++];\r\n                    break;\r\n                }\r\n\r\n                // if array contains no values, no initial value to return\r\n                if (++i >= length) {\r\n                    throw new TypeError(\"reduce of empty array with no initial value\");\r\n                }\r\n            } while (true);\r\n        }\r\n\r\n        for (; i < length; i++) {\r\n            if (i in self) {\r\n                result = fun.call(void 0, result, self[i], i, object);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n}, !reduceCoercesToObject);\r\n\r\n// ES5 15.4.4.22\r\n// http://es5.github.com/#x15.4.4.22\r\n// https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/reduceRight\r\nvar reduceRightCoercesToObject = false;\r\nif (ArrayPrototype.reduceRight) {\r\n    reduceRightCoercesToObject = typeof ArrayPrototype.reduceRight.call('es5', function (_, __, ___, list) { return list; }) === 'object';\r\n}\r\ndefineProperties(ArrayPrototype, {\r\n    reduceRight: function reduceRight(fun /*, initial*/) {\r\n        var object = toObject(this),\r\n            self = splitString && isString(this) ? this.split('') : object,\r\n            length = self.length >>> 0;\r\n\r\n        // If no callback function or if callback is not a callable function\r\n        if (!isFunction(fun)) {\r\n            throw new TypeError(fun + \" is not a function\");\r\n        }\r\n\r\n        // no value to return if no initial value, empty array\r\n        if (!length && arguments.length === 1) {\r\n            throw new TypeError(\"reduceRight of empty array with no initial value\");\r\n        }\r\n\r\n        var result, i = length - 1;\r\n        if (arguments.length >= 2) {\r\n            result = arguments[1];\r\n        } else {\r\n            do {\r\n                if (i in self) {\r\n                    result = self[i--];\r\n                    break;\r\n                }\r\n\r\n                // if array contains no values, no initial value to return\r\n                if (--i < 0) {\r\n                    throw new TypeError(\"reduceRight of empty array with no initial value\");\r\n                }\r\n            } while (true);\r\n        }\r\n\r\n        if (i < 0) {\r\n            return result;\r\n        }\r\n\r\n        do {\r\n            if (i in self) {\r\n                result = fun.call(void 0, result, self[i], i, object);\r\n            }\r\n        } while (i--);\r\n\r\n        return result;\r\n    }\r\n}, !reduceRightCoercesToObject);\r\n\r\n// ES5 15.4.4.14\r\n// http://es5.github.com/#x15.4.4.14\r\n// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf\r\nvar hasFirefox2IndexOfBug = Array.prototype.indexOf && [0, 1].indexOf(1, 2) !== -1;\r\ndefineProperties(ArrayPrototype, {\r\n    indexOf: function indexOf(sought /*, fromIndex */ ) {\r\n        var self = splitString && isString(this) ? this.split('') : toObject(this),\r\n            length = self.length >>> 0;\r\n\r\n        if (!length) {\r\n            return -1;\r\n        }\r\n\r\n        var i = 0;\r\n        if (arguments.length > 1) {\r\n            i = toInteger(arguments[1]);\r\n        }\r\n\r\n        // handle negative indices\r\n        i = i >= 0 ? i : Math.max(0, length + i);\r\n        for (; i < length; i++) {\r\n            if (i in self && self[i] === sought) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n}, hasFirefox2IndexOfBug);\r\n\r\n// ES5 15.4.4.15\r\n// http://es5.github.com/#x15.4.4.15\r\n// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/lastIndexOf\r\nvar hasFirefox2LastIndexOfBug = Array.prototype.lastIndexOf && [0, 1].lastIndexOf(0, -3) !== -1;\r\ndefineProperties(ArrayPrototype, {\r\n    lastIndexOf: function lastIndexOf(sought /*, fromIndex */) {\r\n        var self = splitString && isString(this) ? this.split('') : toObject(this),\r\n            length = self.length >>> 0;\r\n\r\n        if (!length) {\r\n            return -1;\r\n        }\r\n        var i = length - 1;\r\n        if (arguments.length > 1) {\r\n            i = Math.min(i, toInteger(arguments[1]));\r\n        }\r\n        // handle negative indices\r\n        i = i >= 0 ? i : length - Math.abs(i);\r\n        for (; i >= 0; i--) {\r\n            if (i in self && sought === self[i]) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n}, hasFirefox2LastIndexOfBug);\r\n\r\n//\r\n// Object\r\n// ======\r\n//\r\n\r\n// ES5 15.2.3.14\r\n// http://es5.github.com/#x15.2.3.14\r\n\r\n// http://whattheheadsaid.com/2010/10/a-safer-object-keys-compatibility-implementation\r\nvar hasDontEnumBug = !({'toString': null}).propertyIsEnumerable('toString'),\r\n    hasProtoEnumBug = (function () {}).propertyIsEnumerable('prototype'),\r\n    dontEnums = [\r\n        \"toString\",\r\n        \"toLocaleString\",\r\n        \"valueOf\",\r\n        \"hasOwnProperty\",\r\n        \"isPrototypeOf\",\r\n        \"propertyIsEnumerable\",\r\n        \"constructor\"\r\n    ],\r\n    dontEnumsLength = dontEnums.length;\r\n\r\ndefineProperties(Object, {\r\n    keys: function keys(object) {\r\n        var isFn = isFunction(object),\r\n            isArgs = isArguments(object),\r\n            isObject = object !== null && typeof object === 'object',\r\n            isStr = isObject && isString(object);\r\n\r\n        if (!isObject && !isFn && !isArgs) {\r\n            throw new TypeError(\"Object.keys called on a non-object\");\r\n        }\r\n\r\n        var theKeys = [];\r\n        var skipProto = hasProtoEnumBug && isFn;\r\n        if (isStr || isArgs) {\r\n            for (var i = 0; i < object.length; ++i) {\r\n                theKeys.push(String(i));\r\n            }\r\n        } else {\r\n            for (var name in object) {\r\n                if (!(skipProto && name === 'prototype') && owns(object, name)) {\r\n                    theKeys.push(String(name));\r\n                }\r\n            }\r\n        }\r\n\r\n        if (hasDontEnumBug) {\r\n            var ctor = object.constructor,\r\n                skipConstructor = ctor && ctor.prototype === object;\r\n            for (var j = 0; j < dontEnumsLength; j++) {\r\n                var dontEnum = dontEnums[j];\r\n                if (!(skipConstructor && dontEnum === 'constructor') && owns(object, dontEnum)) {\r\n                    theKeys.push(dontEnum);\r\n                }\r\n            }\r\n        }\r\n        return theKeys;\r\n    }\r\n});\r\n\r\nvar keysWorksWithArguments = Object.keys && (function () {\r\n    // Safari 5.0 bug\r\n    return Object.keys(arguments).length === 2;\r\n}(1, 2));\r\nvar originalKeys = Object.keys;\r\ndefineProperties(Object, {\r\n    keys: function keys(object) {\r\n        if (isArguments(object)) {\r\n            return originalKeys(ArrayPrototype.slice.call(object));\r\n        } else {\r\n            return originalKeys(object);\r\n        }\r\n    }\r\n}, !keysWorksWithArguments);\r\n\r\n//\r\n// Date\r\n// ====\r\n//\r\n\r\n// ES5 15.9.5.43\r\n// http://es5.github.com/#x15.9.5.43\r\n// This function returns a String value represent the instance in time\r\n// represented by this Date object. The format of the String is the Date Time\r\n// string format defined in 15.9.1.15. All fields are present in the String.\r\n// The time zone is always UTC, denoted by the suffix Z. If the time value of\r\n// this object is not a finite Number a RangeError exception is thrown.\r\nvar negativeDate = -62198755200000;\r\nvar negativeYearString = \"-000001\";\r\nvar hasNegativeDateBug = Date.prototype.toISOString && new Date(negativeDate).toISOString().indexOf(negativeYearString) === -1;\r\n\r\ndefineProperties(Date.prototype, {\r\n    toISOString: function toISOString() {\r\n        var result, length, value, year, month;\r\n        if (!isFinite(this)) {\r\n            throw new RangeError(\"Date.prototype.toISOString called on non-finite value.\");\r\n        }\r\n\r\n        year = this.getUTCFullYear();\r\n\r\n        month = this.getUTCMonth();\r\n        // see https://github.com/es-shims/es5-shim/issues/111\r\n        year += Math.floor(month / 12);\r\n        month = (month % 12 + 12) % 12;\r\n\r\n        // the date time string format is specified in 15.9.1.15.\r\n        result = [month + 1, this.getUTCDate(), this.getUTCHours(), this.getUTCMinutes(), this.getUTCSeconds()];\r\n        year = (\r\n            (year < 0 ? \"-\" : (year > 9999 ? \"+\" : \"\")) +\r\n            (\"00000\" + Math.abs(year)).slice(0 <= year && year <= 9999 ? -4 : -6)\r\n        );\r\n\r\n        length = result.length;\r\n        while (length--) {\r\n            value = result[length];\r\n            // pad months, days, hours, minutes, and seconds to have two\r\n            // digits.\r\n            if (value < 10) {\r\n                result[length] = \"0\" + value;\r\n            }\r\n        }\r\n        // pad milliseconds to have three digits.\r\n        return (\r\n            year + \"-\" + result.slice(0, 2).join(\"-\") +\r\n            \"T\" + result.slice(2).join(\":\") + \".\" +\r\n            (\"000\" + this.getUTCMilliseconds()).slice(-3) + \"Z\"\r\n        );\r\n    }\r\n}, hasNegativeDateBug);\r\n\r\n\r\n// ES5 15.9.5.44\r\n// http://es5.github.com/#x15.9.5.44\r\n// This function provides a String representation of a Date object for use by\r\n// JSON.stringify (15.12.3).\r\nvar dateToJSONIsSupported = false;\r\ntry {\r\n    dateToJSONIsSupported = (\r\n        Date.prototype.toJSON &&\r\n        new Date(NaN).toJSON() === null &&\r\n        new Date(negativeDate).toJSON().indexOf(negativeYearString) !== -1 &&\r\n        Date.prototype.toJSON.call({ // generic\r\n            toISOString: function () {\r\n                return true;\r\n            }\r\n        })\r\n    );\r\n} catch (e) {\r\n}\r\nif (!dateToJSONIsSupported) {\r\n    Date.prototype.toJSON = function toJSON(key) {\r\n        // When the toJSON method is called with argument key, the following\r\n        // steps are taken:\r\n\r\n        // 1.  Let O be the result of calling ToObject, giving it the this\r\n        // value as its argument.\r\n        // 2. Let tv be toPrimitive(O, hint Number).\r\n        var o = Object(this),\r\n            tv = toPrimitive(o),\r\n            toISO;\r\n        // 3. If tv is a Number and is not finite, return null.\r\n        if (typeof tv === \"number\" && !isFinite(tv)) {\r\n            return null;\r\n        }\r\n        // 4. Let toISO be the result of calling the [[Get]] internal method of\r\n        // O with argument \"toISOString\".\r\n        toISO = o.toISOString;\r\n        // 5. If IsCallable(toISO) is false, throw a TypeError exception.\r\n        if (typeof toISO !== \"function\") {\r\n            throw new TypeError(\"toISOString property is not callable\");\r\n        }\r\n        // 6. Return the result of calling the [[Call]] internal method of\r\n        //  toISO with O as the this value and an empty argument list.\r\n        return toISO.call(o);\r\n\r\n        // NOTE 1 The argument is ignored.\r\n\r\n        // NOTE 2 The toJSON function is intentionally generic; it does not\r\n        // require that its this value be a Date object. Therefore, it can be\r\n        // transferred to other kinds of objects for use as a method. However,\r\n        // it does require that any such object have a toISOString method. An\r\n        // object is free to use the argument key to filter its\r\n        // stringification.\r\n    };\r\n}\r\n\r\n// ES5 15.9.4.2\r\n// http://es5.github.com/#x15.9.4.2\r\n// based on work shared by Daniel Friesen (dantman)\r\n// http://gist.github.com/303249\r\nvar supportsExtendedYears = Date.parse('+033658-09-27T01:46:40.000Z') === 1e15;\r\nvar acceptsInvalidDates = !isNaN(Date.parse('2012-04-04T24:00:00.500Z')) || !isNaN(Date.parse('2012-11-31T23:59:59.000Z'));\r\nvar doesNotParseY2KNewYear = isNaN(Date.parse(\"2000-01-01T00:00:00.000Z\"));\r\nif (!Date.parse || doesNotParseY2KNewYear || acceptsInvalidDates || !supportsExtendedYears) {\r\n    // XXX global assignment won't work in embeddings that use\r\n    // an alternate object for the context.\r\n    Date = (function (NativeDate) {\r\n\r\n        // Date.length === 7\r\n        function Date(Y, M, D, h, m, s, ms) {\r\n            var length = arguments.length;\r\n            if (this instanceof NativeDate) {\r\n                var date = length === 1 && String(Y) === Y ? // isString(Y)\r\n                    // We explicitly pass it through parse:\r\n                    new NativeDate(Date.parse(Y)) :\r\n                    // We have to manually make calls depending on argument\r\n                    // length here\r\n                    length >= 7 ? new NativeDate(Y, M, D, h, m, s, ms) :\r\n                    length >= 6 ? new NativeDate(Y, M, D, h, m, s) :\r\n                    length >= 5 ? new NativeDate(Y, M, D, h, m) :\r\n                    length >= 4 ? new NativeDate(Y, M, D, h) :\r\n                    length >= 3 ? new NativeDate(Y, M, D) :\r\n                    length >= 2 ? new NativeDate(Y, M) :\r\n                    length >= 1 ? new NativeDate(Y) :\r\n                                  new NativeDate();\r\n                // Prevent mixups with unfixed Date object\r\n                date.constructor = Date;\r\n                return date;\r\n            }\r\n            return NativeDate.apply(this, arguments);\r\n        }\r\n\r\n        // 15.9.1.15 Date Time String Format.\r\n        var isoDateExpression = new RegExp(\"^\" +\r\n            \"(\\\\d{4}|[\\+\\-]\\\\d{6})\" + // four-digit year capture or sign +\r\n                                      // 6-digit extended year\r\n            \"(?:-(\\\\d{2})\" + // optional month capture\r\n            \"(?:-(\\\\d{2})\" + // optional day capture\r\n            \"(?:\" + // capture hours:minutes:seconds.milliseconds\r\n                \"T(\\\\d{2})\" + // hours capture\r\n                \":(\\\\d{2})\" + // minutes capture\r\n                \"(?:\" + // optional :seconds.milliseconds\r\n                    \":(\\\\d{2})\" + // seconds capture\r\n                    \"(?:(\\\\.\\\\d{1,}))?\" + // milliseconds capture\r\n                \")?\" +\r\n            \"(\" + // capture UTC offset component\r\n                \"Z|\" + // UTC capture\r\n                \"(?:\" + // offset specifier +/-hours:minutes\r\n                    \"([-+])\" + // sign capture\r\n                    \"(\\\\d{2})\" + // hours offset capture\r\n                    \":(\\\\d{2})\" + // minutes offset capture\r\n                \")\" +\r\n            \")?)?)?)?\" +\r\n        \"$\");\r\n\r\n        var months = [\r\n            0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365\r\n        ];\r\n\r\n        function dayFromMonth(year, month) {\r\n            var t = month > 1 ? 1 : 0;\r\n            return (\r\n                months[month] +\r\n                Math.floor((year - 1969 + t) / 4) -\r\n                Math.floor((year - 1901 + t) / 100) +\r\n                Math.floor((year - 1601 + t) / 400) +\r\n                365 * (year - 1970)\r\n            );\r\n        }\r\n\r\n        function toUTC(t) {\r\n            return Number(new NativeDate(1970, 0, 1, 0, 0, 0, t));\r\n        }\r\n\r\n        // Copy any custom methods a 3rd party library may have added\r\n        for (var key in NativeDate) {\r\n            Date[key] = NativeDate[key];\r\n        }\r\n\r\n        // Copy \"native\" methods explicitly; they may be non-enumerable\r\n        Date.now = NativeDate.now;\r\n        Date.UTC = NativeDate.UTC;\r\n        Date.prototype = NativeDate.prototype;\r\n        Date.prototype.constructor = Date;\r\n\r\n        // Upgrade Date.parse to handle simplified ISO 8601 strings\r\n        Date.parse = function parse(string) {\r\n            var match = isoDateExpression.exec(string);\r\n            if (match) {\r\n                // parse months, days, hours, minutes, seconds, and milliseconds\r\n                // provide default values if necessary\r\n                // parse the UTC offset component\r\n                var year = Number(match[1]),\r\n                    month = Number(match[2] || 1) - 1,\r\n                    day = Number(match[3] || 1) - 1,\r\n                    hour = Number(match[4] || 0),\r\n                    minute = Number(match[5] || 0),\r\n                    second = Number(match[6] || 0),\r\n                    millisecond = Math.floor(Number(match[7] || 0) * 1000),\r\n                    // When time zone is missed, local offset should be used\r\n                    // (ES 5.1 bug)\r\n                    // see https://bugs.ecmascript.org/show_bug.cgi?id=112\r\n                    isLocalTime = Boolean(match[4] && !match[8]),\r\n                    signOffset = match[9] === \"-\" ? 1 : -1,\r\n                    hourOffset = Number(match[10] || 0),\r\n                    minuteOffset = Number(match[11] || 0),\r\n                    result;\r\n                if (\r\n                    hour < (\r\n                        minute > 0 || second > 0 || millisecond > 0 ?\r\n                        24 : 25\r\n                    ) &&\r\n                    minute < 60 && second < 60 && millisecond < 1000 &&\r\n                    month > -1 && month < 12 && hourOffset < 24 &&\r\n                    minuteOffset < 60 && // detect invalid offsets\r\n                    day > -1 &&\r\n                    day < (\r\n                        dayFromMonth(year, month + 1) -\r\n                        dayFromMonth(year, month)\r\n                    )\r\n                ) {\r\n                    result = (\r\n                        (dayFromMonth(year, month) + day) * 24 +\r\n                        hour +\r\n                        hourOffset * signOffset\r\n                    ) * 60;\r\n                    result = (\r\n                        (result + minute + minuteOffset * signOffset) * 60 +\r\n                        second\r\n                    ) * 1000 + millisecond;\r\n                    if (isLocalTime) {\r\n                        result = toUTC(result);\r\n                    }\r\n                    if (-8.64e15 <= result && result <= 8.64e15) {\r\n                        return result;\r\n                    }\r\n                }\r\n                return NaN;\r\n            }\r\n            return NativeDate.parse.apply(this, arguments);\r\n        };\r\n\r\n        return Date;\r\n    })(Date);\r\n}\r\n\r\n// ES5 15.9.4.4\r\n// http://es5.github.com/#x15.9.4.4\r\nif (!Date.now) {\r\n    Date.now = function now() {\r\n        return new Date().getTime();\r\n    };\r\n}\r\n\r\n\r\n//\r\n// Number\r\n// ======\r\n//\r\n\r\n// ES5.1 15.7.4.5\r\n// http://es5.github.com/#x15.7.4.5\r\nvar hasToFixedBugs = NumberPrototype.toFixed && (\r\n  (0.00008).toFixed(3) !== '0.000'\r\n  || (0.9).toFixed(0) !== '1'\r\n  || (1.255).toFixed(2) !== '1.25'\r\n  || (1000000000000000128).toFixed(0) !== \"1000000000000000128\"\r\n);\r\n\r\nvar toFixedHelpers = {\r\n  base: 1e7,\r\n  size: 6,\r\n  data: [0, 0, 0, 0, 0, 0],\r\n  multiply: function multiply(n, c) {\r\n      var i = -1;\r\n      while (++i < toFixedHelpers.size) {\r\n          c += n * toFixedHelpers.data[i];\r\n          toFixedHelpers.data[i] = c % toFixedHelpers.base;\r\n          c = Math.floor(c / toFixedHelpers.base);\r\n      }\r\n  },\r\n  divide: function divide(n) {\r\n      var i = toFixedHelpers.size, c = 0;\r\n      while (--i >= 0) {\r\n          c += toFixedHelpers.data[i];\r\n          toFixedHelpers.data[i] = Math.floor(c / n);\r\n          c = (c % n) * toFixedHelpers.base;\r\n      }\r\n  },\r\n  numToString: function numToString() {\r\n      var i = toFixedHelpers.size;\r\n      var s = '';\r\n      while (--i >= 0) {\r\n          if (s !== '' || i === 0 || toFixedHelpers.data[i] !== 0) {\r\n              var t = String(toFixedHelpers.data[i]);\r\n              if (s === '') {\r\n                  s = t;\r\n              } else {\r\n                  s += '0000000'.slice(0, 7 - t.length) + t;\r\n              }\r\n          }\r\n      }\r\n      return s;\r\n  },\r\n  pow: function pow(x, n, acc) {\r\n      return (n === 0 ? acc : (n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc)));\r\n  },\r\n  log: function log(x) {\r\n      var n = 0;\r\n      while (x >= 4096) {\r\n          n += 12;\r\n          x /= 4096;\r\n      }\r\n      while (x >= 2) {\r\n          n += 1;\r\n          x /= 2;\r\n      }\r\n      return n;\r\n  }\r\n};\r\n\r\ndefineProperties(NumberPrototype, {\r\n    toFixed: function toFixed(fractionDigits) {\r\n        var f, x, s, m, e, z, j, k;\r\n\r\n        // Test for NaN and round fractionDigits down\r\n        f = Number(fractionDigits);\r\n        f = f !== f ? 0 : Math.floor(f);\r\n\r\n        if (f < 0 || f > 20) {\r\n            throw new RangeError(\"Number.toFixed called with invalid number of decimals\");\r\n        }\r\n\r\n        x = Number(this);\r\n\r\n        // Test for NaN\r\n        if (x !== x) {\r\n            return \"NaN\";\r\n        }\r\n\r\n        // If it is too big or small, return the string value of the number\r\n        if (x <= -1e21 || x >= 1e21) {\r\n            return String(x);\r\n        }\r\n\r\n        s = \"\";\r\n\r\n        if (x < 0) {\r\n            s = \"-\";\r\n            x = -x;\r\n        }\r\n\r\n        m = \"0\";\r\n\r\n        if (x > 1e-21) {\r\n            // 1e-21 < x < 1e21\r\n            // -70 < log2(x) < 70\r\n            e = toFixedHelpers.log(x * toFixedHelpers.pow(2, 69, 1)) - 69;\r\n            z = (e < 0 ? x * toFixedHelpers.pow(2, -e, 1) : x / toFixedHelpers.pow(2, e, 1));\r\n            z *= 0x10000000000000; // Math.pow(2, 52);\r\n            e = 52 - e;\r\n\r\n            // -18 < e < 122\r\n            // x = z / 2 ^ e\r\n            if (e > 0) {\r\n                toFixedHelpers.multiply(0, z);\r\n                j = f;\r\n\r\n                while (j >= 7) {\r\n                    toFixedHelpers.multiply(1e7, 0);\r\n                    j -= 7;\r\n                }\r\n\r\n                toFixedHelpers.multiply(toFixedHelpers.pow(10, j, 1), 0);\r\n                j = e - 1;\r\n\r\n                while (j >= 23) {\r\n                    toFixedHelpers.divide(1 << 23);\r\n                    j -= 23;\r\n                }\r\n\r\n                toFixedHelpers.divide(1 << j);\r\n                toFixedHelpers.multiply(1, 1);\r\n                toFixedHelpers.divide(2);\r\n                m = toFixedHelpers.numToString();\r\n            } else {\r\n                toFixedHelpers.multiply(0, z);\r\n                toFixedHelpers.multiply(1 << (-e), 0);\r\n                m = toFixedHelpers.numToString() + '0.00000000000000000000'.slice(2, 2 + f);\r\n            }\r\n        }\r\n\r\n        if (f > 0) {\r\n            k = m.length;\r\n\r\n            if (k <= f) {\r\n                m = s + '0.0000000000000000000'.slice(0, f - k + 2) + m;\r\n            } else {\r\n                m = s + m.slice(0, k - f) + '.' + m.slice(k - f);\r\n            }\r\n        } else {\r\n            m = s + m;\r\n        }\r\n\r\n        return m;\r\n    }\r\n}, hasToFixedBugs);\r\n\r\n\r\n//\r\n// String\r\n// ======\r\n//\r\n\r\n// ES5 15.5.4.14\r\n// http://es5.github.com/#x15.5.4.14\r\n\r\n// [bugfix, IE lt 9, firefox 4, Konqueror, Opera, obscure browsers]\r\n// Many browsers do not split properly with regular expressions or they\r\n// do not perform the split correctly under obscure conditions.\r\n// See http://blog.stevenlevithan.com/archives/cross-browser-split\r\n// I've tested in many browsers and this seems to cover the deviant ones:\r\n//    'ab'.split(/(?:ab)*/) should be [\"\", \"\"], not [\"\"]\r\n//    '.'.split(/(.?)(.?)/) should be [\"\", \".\", \"\", \"\"], not [\"\", \"\"]\r\n//    'tesst'.split(/(s)*/) should be [\"t\", undefined, \"e\", \"s\", \"t\"], not\r\n//       [undefined, \"t\", undefined, \"e\", ...]\r\n//    ''.split(/.?/) should be [], not [\"\"]\r\n//    '.'.split(/()()/) should be [\".\"], not [\"\", \"\", \".\"]\r\n\r\nvar string_split = StringPrototype.split;\r\nif (\r\n    'ab'.split(/(?:ab)*/).length !== 2 ||\r\n    '.'.split(/(.?)(.?)/).length !== 4 ||\r\n    'tesst'.split(/(s)*/)[1] === \"t\" ||\r\n    'test'.split(/(?:)/, -1).length !== 4 ||\r\n    ''.split(/.?/).length ||\r\n    '.'.split(/()()/).length > 1\r\n) {\r\n    (function () {\r\n        var compliantExecNpcg = /()??/.exec(\"\")[1] === void 0; // NPCG: nonparticipating capturing group\r\n\r\n        StringPrototype.split = function (separator, limit) {\r\n            var string = this;\r\n            if (separator === void 0 && limit === 0) {\r\n                return [];\r\n            }\r\n\r\n            // If `separator` is not a regex, use native split\r\n            if (_toString.call(separator) !== \"[object RegExp]\") {\r\n                return string_split.call(this, separator, limit);\r\n            }\r\n\r\n            var output = [],\r\n                flags = (separator.ignoreCase ? \"i\" : \"\") +\r\n                        (separator.multiline  ? \"m\" : \"\") +\r\n                        (separator.extended   ? \"x\" : \"\") + // Proposed for ES6\r\n                        (separator.sticky     ? \"y\" : \"\"), // Firefox 3+\r\n                lastLastIndex = 0,\r\n                // Make `global` and avoid `lastIndex` issues by working with a copy\r\n                separator2, match, lastIndex, lastLength;\r\n            separator = new RegExp(separator.source, flags + \"g\");\r\n            string += \"\"; // Type-convert\r\n            if (!compliantExecNpcg) {\r\n                // Doesn't need flags gy, but they don't hurt\r\n                separator2 = new RegExp(\"^\" + separator.source + \"$(?!\\\\s)\", flags);\r\n            }\r\n            /* Values for `limit`, per the spec:\r\n             * If undefined: 4294967295 // Math.pow(2, 32) - 1\r\n             * If 0, Infinity, or NaN: 0\r\n             * If positive number: limit = Math.floor(limit); if (limit > 4294967295) limit -= 4294967296;\r\n             * If negative number: 4294967296 - Math.floor(Math.abs(limit))\r\n             * If other: Type-convert, then use the above rules\r\n             */\r\n            limit = limit === void 0 ?\r\n                -1 >>> 0 : // Math.pow(2, 32) - 1\r\n                ToUint32(limit);\r\n            while (match = separator.exec(string)) {\r\n                // `separator.lastIndex` is not reliable cross-browser\r\n                lastIndex = match.index + match[0].length;\r\n                if (lastIndex > lastLastIndex) {\r\n                    output.push(string.slice(lastLastIndex, match.index));\r\n                    // Fix browsers whose `exec` methods don't consistently return `undefined` for\r\n                    // nonparticipating capturing groups\r\n                    if (!compliantExecNpcg && match.length > 1) {\r\n                        match[0].replace(separator2, function () {\r\n                            for (var i = 1; i < arguments.length - 2; i++) {\r\n                                if (arguments[i] === void 0) {\r\n                                    match[i] = void 0;\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    if (match.length > 1 && match.index < string.length) {\r\n                        ArrayPrototype.push.apply(output, match.slice(1));\r\n                    }\r\n                    lastLength = match[0].length;\r\n                    lastLastIndex = lastIndex;\r\n                    if (output.length >= limit) {\r\n                        break;\r\n                    }\r\n                }\r\n                if (separator.lastIndex === match.index) {\r\n                    separator.lastIndex++; // Avoid an infinite loop\r\n                }\r\n            }\r\n            if (lastLastIndex === string.length) {\r\n                if (lastLength || !separator.test(\"\")) {\r\n                    output.push(\"\");\r\n                }\r\n            } else {\r\n                output.push(string.slice(lastLastIndex));\r\n            }\r\n            return output.length > limit ? output.slice(0, limit) : output;\r\n        };\r\n    }());\r\n\r\n// [bugfix, chrome]\r\n// If separator is undefined, then the result array contains just one String,\r\n// which is the this value (converted to a String). If limit is not undefined,\r\n// then the output array is truncated so that it contains no more than limit\r\n// elements.\r\n// \"0\".split(undefined, 0) -> []\r\n} else if (\"0\".split(void 0, 0).length) {\r\n    StringPrototype.split = function split(separator, limit) {\r\n        if (separator === void 0 && limit === 0) { return []; }\r\n        return string_split.call(this, separator, limit);\r\n    };\r\n}\r\n\r\nvar str_replace = StringPrototype.replace;\r\nvar replaceReportsGroupsCorrectly = (function () {\r\n    var groups = [];\r\n    'x'.replace(/x(.)?/g, function (match, group) {\r\n        groups.push(group);\r\n    });\r\n    return groups.length === 1 && typeof groups[0] === 'undefined';\r\n}());\r\n\r\nif (!replaceReportsGroupsCorrectly) {\r\n    StringPrototype.replace = function replace(searchValue, replaceValue) {\r\n        var isFn = isFunction(replaceValue);\r\n        var hasCapturingGroups = isRegex(searchValue) && (/\\)[*?]/).test(searchValue.source);\r\n        if (!isFn || !hasCapturingGroups) {\r\n            return str_replace.call(this, searchValue, replaceValue);\r\n        } else {\r\n            var wrappedReplaceValue = function (match) {\r\n                var length = arguments.length;\r\n                var originalLastIndex = searchValue.lastIndex;\r\n                searchValue.lastIndex = 0;\r\n                var args = searchValue.exec(match);\r\n                searchValue.lastIndex = originalLastIndex;\r\n                args.push(arguments[length - 2], arguments[length - 1]);\r\n                return replaceValue.apply(this, args);\r\n            };\r\n            return str_replace.call(this, searchValue, wrappedReplaceValue);\r\n        }\r\n    };\r\n}\r\n\r\n// ECMA-262, 3rd B.2.3\r\n// Not an ECMAScript standard, although ECMAScript 3rd Edition has a\r\n// non-normative section suggesting uniform semantics and it should be\r\n// normalized across all browsers\r\n// [bugfix, IE lt 9] IE < 9 substr() with negative value not working in IE\r\nvar string_substr = StringPrototype.substr;\r\nvar hasNegativeSubstrBug = \"\".substr && \"0b\".substr(-1) !== \"b\";\r\ndefineProperties(StringPrototype, {\r\n    substr: function substr(start, length) {\r\n        return string_substr.call(\r\n            this,\r\n            start < 0 ? ((start = this.length + start) < 0 ? 0 : start) : start,\r\n            length\r\n        );\r\n    }\r\n}, hasNegativeSubstrBug);\r\n\r\n// ES5 15.5.4.20\r\n// whitespace from: http://es5.github.io/#x15.5.4.20\r\nvar ws = \"\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\" +\r\n    \"\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\" +\r\n    \"\\u2029\\uFEFF\";\r\nvar zeroWidth = '\\u200b';\r\nvar wsRegexChars = \"[\" + ws + \"]\";\r\nvar trimBeginRegexp = new RegExp(\"^\" + wsRegexChars + wsRegexChars + \"*\");\r\nvar trimEndRegexp = new RegExp(wsRegexChars + wsRegexChars + \"*$\");\r\nvar hasTrimWhitespaceBug = StringPrototype.trim && (ws.trim() || !zeroWidth.trim());\r\ndefineProperties(StringPrototype, {\r\n    // http://blog.stevenlevithan.com/archives/faster-trim-javascript\r\n    // http://perfectionkills.com/whitespace-deviations/\r\n    trim: function trim() {\r\n        if (this === void 0 || this === null) {\r\n            throw new TypeError(\"can't convert \" + this + \" to object\");\r\n        }\r\n        return String(this).replace(trimBeginRegexp, \"\").replace(trimEndRegexp, \"\");\r\n    }\r\n}, hasTrimWhitespaceBug);\r\n\r\n// ES-5 15.1.2.2\r\nif (parseInt(ws + '08') !== 8 || parseInt(ws + '0x16') !== 22) {\r\n    parseInt = (function (origParseInt) {\r\n        var hexRegex = /^0[xX]/;\r\n        return function parseIntES5(str, radix) {\r\n            str = String(str).trim();\r\n            if (!Number(radix)) {\r\n                radix = hexRegex.test(str) ? 16 : 10;\r\n            }\r\n            return origParseInt(str, radix);\r\n        };\r\n    }(parseInt));\r\n}\r\n\r\n}));\r\n\r\n/** @namespace */\nvar ozpIwc=ozpIwc || {};\n\n/**\n\t* @class\n\t*/\nozpIwc.Event=function() {\n\tthis.events={};\n};\n\n/**\n * Registers a handler for the the event.\n * @param {string} event The name of the event to trigger on\n * @param {function} callback Function to be invoked\n * @param {object} [self] Used as the this pointer when callback is invoked.\n * @returns {object} A handle that can be used to unregister the callback via [off()]{@link ozpIwc.Event#off}\n */\nozpIwc.Event.prototype.on=function(event,callback,self) {\n\tvar wrapped=callback;\n\tif(self) {\n\t\twrapped=function() {\n\t\t\tcallback.apply(self,arguments);\n\t\t};\n\t\twrapped.ozpIwcDelegateFor=callback;\n\t}\n\tthis.events[event]=this.events[event]||[];\n\tthis.events[event].push(wrapped);\n\treturn wrapped;\n};\n\n/**\n * Unregisters an event handler previously registered.\n * @param {type} event\n * @param {type} callback\n */\nozpIwc.Event.prototype.off=function(event,callback) {\n\tthis.events[event]=(this.events[event]||[]).filter( function(h) {\n\t\treturn h!==callback && h.ozpIwcDelegateFor !== callback;\n\t});\n};\n\n/**\n * Fires an event that will be received by all handlers.\n * @param {string} eventName  - Name of the event\n * @param {object} event - Event object to pass to the handers.\n * @returns {object} The event after all handlers have processed it\n */\nozpIwc.Event.prototype.trigger=function(eventName,event) {\n\tevent = event || new ozpIwc.CancelableEvent();\n\tvar handlers=this.events[eventName] || [];\n\n\thandlers.forEach(function(h) {\n\t\th(event);\n\t});\n\treturn event;\n};\n\n\n/**\n * Adds an on() and off() function to the target that delegate to this object\n * @param {object} target Target to receive the on/off functions\n */\nozpIwc.Event.prototype.mixinOnOff=function(target) {\n\tvar self=this;\n\ttarget.on=function() { return self.on.apply(self,arguments);};\n\ttarget.off=function() { return self.off.apply(self,arguments);};\n};\n\n/**\n * Convenient base for events that can be canceled.  Provides and manages\n * the properties canceled and cancelReason, as well as the member function\n * cancel().\n * @class\n * @param {object} data - Data that will be copied into the event\n */\nozpIwc.CancelableEvent=function(data) {\n\tdata = data || {};\n\tfor(var k in data) {\n\t\tthis[k]=data[k];\n\t}\n\tthis.canceled=false;\n\tthis.cancelReason=null;\n};\n\n/**\n * Marks the event as canceled.\n * @param {type} reason - A text description of why the event was canceled.\n * @returns {ozpIwc.CancelableEvent} Reference to self\n */\nozpIwc.CancelableEvent.prototype.cancel=function(reason) {\n\treason= reason || \"Unknown\";\n\tthis.canceled=true;\n\tthis.cancelReason=reason;\n\treturn this;\n};\n\r\n/** @namespace */\nvar ozpIwc=ozpIwc || {};\n\n/**\n * @type {object}\n * @property {function} log - Normal log output.\n * @property {function} error - Error output.\n */\nozpIwc.log=ozpIwc.log || {\n\tlog: function() {\n\t\tif(window.console && typeof(window.console.log)===\"function\") {\n\t\t\twindow.console.log.apply(window.console,arguments);\n\t\t}\n\t},\n\terror: function() {\n\t\tif(window.console && typeof(window.console.error)===\"function\") {\n\t\t\twindow.console.error.apply(window.console,arguments);\n\t\t}\n\t}\n};\n\r\n/** @namespace */\nvar ozpIwc=ozpIwc || {};\n\n/** @namespace */\nozpIwc.util=ozpIwc.util || {};\n\n/**\n * Generates a large hexidecimal string to serve as a unique ID.  Not a guid.\n * @returns {String}\n */\nozpIwc.util.generateId=function() {\n    return Math.floor(Math.random() * 0xffffffff).toString(16);\n};\n\n/**\n * Used to get the current epoch time.  Tests overrides this\n * to allow a fast-forward on time-based actions.\n * @returns {Number}\n */\nozpIwc.util.now=function() {\n    return new Date().getTime();\n};\n\n/**\n * Create a class with the given parent in it's prototype chain.\n * @param {function} baseClass - the class being derived from\n * @param {function} newConstructor - the new base class\n * @returns {Function} newConstructor with an augmented prototype\n */\nozpIwc.util.extend=function(baseClass,newConstructor) {\n    if(!baseClass || !baseClass.prototype) {\n        console.error(\"Cannot create a new class for \",newConstructor,\" due to invalid baseclass:\",baseClass);\n        throw new Error(\"Cannot create a new class due to invalid baseClass.  Dependency not loaded first?\");\n    };\n    newConstructor.prototype = Object.create(baseClass.prototype);\n    newConstructor.prototype.constructor = newConstructor;\n    return newConstructor;\n};\n\n/**\n * Invokes the callback handler on another event loop as soon as possible.\n*/\nozpIwc.util.setImmediate=function(f) {\n//    window.setTimeout(f,0);\n    window.setImmediate(f);\n};\n\n/**\n * Detect browser support for structured clones.\n * @returns {boolean} - true if structured clones are supported,\n * false otherwise\n */\nozpIwc.util.structuredCloneSupport=function() {\n    if (ozpIwc.util.structuredCloneSupport.cache !== undefined) {\n        return ozpIwc.util.structuredCloneSupport.cache;\n    }\n    var onlyStrings = false;\n    //If the browser doesn't support structured clones, it will call toString() on the object passed to postMessage.\n    //A bug in FF will cause File clone to fail (see https://bugzilla.mozilla.org/show_bug.cgi?id=722126)\n    //We detect this using a test Blob\n    try {\n        window.postMessage({\n            toString: function () {\n                onlyStrings = true;\n            },\n            blob: new Blob()\n        }, \"*\");\n    } catch (e) {\n        onlyStrings=true;\n    }\n    ozpIwc.util.structuredCloneSupport.cache=!onlyStrings;\n    return ozpIwc.util.structuredCloneSupport.cache;\n};\n\nozpIwc.util.structuredCloneSupport.cache=undefined;\n\n/**\n * Does a deep clone of a serializable object.  Note that this will not\n * clone unserializable objects like DOM elements, Date, RegExp, etc.\n * @param {type} value - value to be cloned.\n * @returns {object} - a deep copy of the object\n */\nozpIwc.util.clone=function(value) {\n\tif(Array.isArray(value) || typeof(value) === 'object') {\n        try {\n            return JSON.parse(JSON.stringify(value));\n        } catch (e) {\n            console.log(e);\n        }\n\t} else {\n\t\treturn value;\n\t}\n};\n\n\n/**\n * Returns true if every needle is found in the haystack.\n * @param {array} haystack - The array to search.\n * @param {array} needles - All of the values to search.\n * @param {function} [equal] - What constitutes equality.  Defaults to a===b.\n * @returns {boolean}\n */\nozpIwc.util.arrayContainsAll=function(haystack,needles,equal) {\n    equal=equal || function(a,b) { return a===b;};\n    return needles.every(function(needle) { \n        return haystack.some(function(hay) { \n            return equal(hay,needle);\n        });\n    });\n};\n\n\n/**\n * Returns true if the value every attribute in needs is equal to \n * value of the same attribute in haystack.\n * @param {array} haystack - The object that must contain all attributes and values.\n * @param {array} needles - The reference object for the attributes and values.\n * @param {function} [equal] - What constitutes equality.  Defaults to a===b.\n * @returns {boolean}\n */\nozpIwc.util.objectContainsAll=function(haystack,needles,equal) {\n    equal=equal || function(a,b) { return a===b;};\n    \n    for(var attribute in needles) {\n        if(!equal(haystack[attribute],needles[attribute])) {\n            return false;\n        }\n    }\n    return true;\n};\n\nozpIwc.util.parseQueryParams=function(query) {\n    query = query || window.location.search;\n    var params={};\n\tvar regex=/\\??([^&=]+)=?([^&]*)/g;\n\tvar match;\n\twhile(match=regex.exec(query)) {\n\t\tparams[match[1]]=decodeURIComponent(match[2]);\n\t}\n    return params;\n};\n\nozpIwc.util.ajax = function (config) {\n\n    var result = new ozpIwc.AsyncAction();\n    var request = new XMLHttpRequest();\n\n    request.onreadystatechange = function() {\n        if (request.readyState !== 4) {\n            return;\n        }\n\n        if (request.status === 200) {\n            result.resolve(\"success\", JSON.parse(this.responseText));\n        } else {\n            result.resolve(\"failure\", this.statusText, this.responseText);\n        }\n    };\n    request.open(config.method, config.href, true);\n\n    if(config.method === \"POST\") {\n        request.send(config.data);\n    }\n    request.setRequestHeader(\"Content-Type\", \"application/json\");\n    request.setRequestHeader(\"Cache-Control\", \"no-cache\");\n    request.send();\n\n    return result;\n};\r\nvar ozpIwc=ozpIwc || {};\n\n/**\n * @class\n * This class will be heavily modified in the future.\n *\n * @todo accept a list of peer URLs that are searched in order of preference\n * @param {object} config\n * @param {string} config.peerUrl - Base URL of the peer server\n * @param {boolean} [config.autoPeer=true] - Whether to automatically find and connect to a peer\n */\nozpIwc.Client=function(config) {\n\tconfig=config || {};\n\tthis.address=\"$nobody\";\n\tthis.replyCallbacks={};\n\tthis.peerUrl=config.peerUrl;\n\tvar a=document.createElement(\"a\");\n\ta.href = this.peerUrl;\n\tthis.peerOrigin=a.protocol + \"//\" + a.hostname;\n\tif(a.port)\n\t\tthis.peerOrigin+= \":\" + a.port;\n\t\n\t\n\tthis.autoPeer=(\"autoPeer\" in config) ? config.autoPeer : true;\n\tthis.msgIdSequence=0;\n\tthis.events=new ozpIwc.Event();\n\tthis.events.mixinOnOff(this);\n\tthis.receivedPackets=0;\n\tthis.receivedBytes=0;\n\tthis.sentPackets=0;\n\tthis.sentBytes=0;\n\tthis.startTime=ozpIwc.util.now();\n    this.window = window;\n\tvar self=this;\n\n\tif(this.autoPeer) {\n\t\tthis.findPeer();\n\t}\n\n    this.postMessageHandler = function(event) {\n        if(event.origin !== self.peerOrigin){\n            return;\n        }\n        try {\n            var message=event.data;\n            if (typeof(message) === 'string') {\n                message=JSON.parse(event.data);\n            }\n            self.receive(message);\n            self.receivedBytes+=(event.data.length * 2);\n            self.receivedPackets++;\n        } catch(e) {\n            // ignore!\n        }\n    };\n\t// receive postmessage events\n\twindow.addEventListener(\"message\", this.postMessageHandler, false);\n    \n    this.preconnectionQueue=[];\n    \n    this.on(\"connected\",function() {\n        self.preconnectionQueue.forEach(function(p) {\n            console.log(\"Sending from queue: \",p);\n            self.send(p.fields,p.callback,p.promise);\n        });\n        self.preconnectionQueue=null;\n    });\n};\n\n/**\n * Receive a packet from the connected peer.  If the packet is a reply, then\n * the callback for that reply is invoked.  Otherwise, it fires a receive event\n * @fires ozpIwc.Client#receive\n * @protected\n * @param {ozpIwc.TransportPacket} packet\n * @returns {undefined}\n */\nozpIwc.Client.prototype.receive=function(packet) {\n    if(packet.replyTo && this.replyCallbacks[packet.replyTo]) {\n        if (!this.replyCallbacks[packet.replyTo](packet)) {\n            this.cancelCallback(packet.replyTo);\n        }\n    } else {\n        this.events.trigger(\"receive\",packet);\n    }\n};\n/**\n * Used to send a packet\n * @param {string} dst - where to send the packet\n * @param {object} entity - payload of the packet\n * @param {function} callback - callback for any replies. The callback will be\n * persisted if it returns a truth-like value, canceled if it returns a\n * false-like value.\n */\nozpIwc.Client.prototype.send=function(fields,callback,preexistingPromise) {\n    var promise= preexistingPromise; // || new Promise();\n    if(!(this.isConnected() || fields.dst==\"$transport\")) {\n        // when send is switched to promises, create the promise first and return it here, as well\n        console.log(\"Queuing to be sent later:\",arguments);\n        this.preconnectionQueue.push({\n            'fields': fields,\n            'callback': callback,\n            'promise': promise\n        });\n        return promise;\n    }\n    var now=new Date().getTime();\n\tvar id=\"p:\"+this.msgIdSequence++; // makes the code below read better\n\tvar packet={\n\t\tver: 1,\n\t\tsrc: this.address,\n\t\tmsgId: id,\n\t\ttime: now\n\t};\n\n\tfor(var k in fields) {\n\t\tpacket[k]=fields[k];\n\t}\n\n\tif(callback) {\n\t\tthis.replyCallbacks[id]=callback;\n\t}\n\tvar data=packet;\n    if (!ozpIwc.util.structuredCloneSupport()) {\n        data=JSON.stringify(packet);\n    }\n\tthis.peer.postMessage(data,'*');\n\tthis.sentBytes+=data.length;\n\tthis.sentPackets++;\n\treturn packet;\n};\nozpIwc.Client.prototype.isConnected=function(){\n\treturn this.address !== \"$nobody\";\n};\n/**\n * Cancel a callback registration\n * @param (string} msgId - The packet replyTo ID for which the callback was registered\n */\nozpIwc.Client.prototype.cancelCallback=function(msgId) {\n    var success=false;\n    if (msgId) {\n        delete this.replyCallbacks[msgId];\n        success=true;\n    }\n    return success;\n};\n\n\nozpIwc.Client.prototype.on=function(event,callback) {\n\tif(event===\"connected\" && this.isConnected()) {\n\t\tcallback(this);\n\t\treturn;\n\t}\n\treturn this.events.on.apply(this.events,arguments);\n};\n\nozpIwc.Client.prototype.off=function(event,callback) {\n    return this.events.off.apply(this.events,arguments);\n};\n\nozpIwc.Client.prototype.disconnect=function() {\n    this.replyCallbacks={};\n    window.removeEventListener(\"message\",this.postMessageHandler,false);\n    if(this.iframe) {\n        document.body.removeChild(this.iframe);\n    }\n};\n\nozpIwc.Client.prototype.createIframePeer=function(peerUrl) {\n    var self=this;\n    var createIframeShim=function() {\n        self.iframe=document.createElement(\"iframe\");\n        self.iframe.src=peerUrl+\"/iframe_peer.html\";\n        self.iframe.height=1;\n        self.iframe.width=1;\n        self.iframe.style.setProperty (\"display\", \"none\", \"important\")\n        self.iframe.addEventListener(\"load\",function() { self.requestAddress(); },false);\n        document.body.appendChild(self.iframe);\n        self.peer=self.iframe.contentWindow;\n\n    };\n    // need at least the body tag to be loaded, so wait until it's loaded\n    if(document.readyState === 'complete' ) {\n        createIframeShim();\n    } else {\n        window.addEventListener(\"load\",createIframeShim,false);\n    }\n};\n\nozpIwc.Client.prototype.findPeer=function() {\n    // check if we have a parent, get address there if so\n//\tif(window.parent!==window) {\n//\t\tthis.peer=window.parent;\n//\t\tthis.requestAddress();\n//\t} else {\n    this.createIframePeer(this.peerUrl);\n//\t}\n};\n\nozpIwc.Client.prototype.requestAddress=function(){\n\t// send connect to get our address\n\tvar self=this;\n\tthis.send({dst:\"$transport\"},function(message) {\n\t\tself.address=message.dst;\n\t\tself.events.trigger(\"connected\",self);\n        return null;//de-register callback\n\t});\n};\r\n//# sourceMappingURL=ozpIwc-client.js.map"]}